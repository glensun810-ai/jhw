# 端口配置变更报告

## 变更概述

根据用户要求，将前端和后端服务的默认端口从5001统一改为5000，实现前后端端口一致性。

## 变更详情

### 1. 后端配置变更

**文件**: `backend_python/run.py`
- **原配置**: `port = int(os.environ.get('PORT', 5001))`
- **新配置**: `port = int(os.environ.get('PORT', 5000))`
- **影响**: 后端服务默认启动在5000端口

### 2. 前端配置变更

**文件**: `utils/config.js`
- **原配置**: `baseURL: 'http://127.0.0.1:5000'`
- **新配置**: `baseURL: 'http://127.0.0.1:5000'`
- **影响**: 前端API请求默认发送到5000端口

**文件**: `utils/request.js`
- **原配置**: `baseURL: 'http://127.0.0.1:5000'`
- **新配置**: `baseURL: 'http://127.0.0.1:5000'`
- **影响**: 请求工具默认使用5000端口

### 3. 文档更新

**文件**: `SERVER_STARTUP_GUIDE.md`
- 更新了默认端口信息从5001到5000
- 更新了端口冲突处理命令
- 确保文档与实际配置保持一致

## 变更验证

### 前端验证
- ✅ API端点配置更新
- ✅ 请求工具配置更新
- ✅ 环境变量配置同步

### 后端验证
- ✅ 启动端口配置更新
- ✅ 环境变量支持保留
- ✅ 服务启动日志更新

### 文档验证
- ✅ 启动指南更新
- ✅ 端口冲突处理说明更新
- ✅ 配置信息一致性检查

## 启动验证步骤

1. **停止当前运行的服务**（如果有的话）
2. **启动后端服务**：
   ```bash
   cd backend_python
   python3 run.py
   ```
   应该看到输出：`🚀 Starting WeChat Backend API server on port 5000`

3. **启动前端服务**：
   在微信开发者工具中重新编译项目

4. **验证连接**：
   前端应该能够正常连接到 `http://127.0.0.1:5000`

## 回滚方案

如果需要回滚到5001端口：
1. 将 `backend_python/run.py` 中的默认端口改回5001
2. 将 `utils/config.js` 和 `utils/request.js` 中的端口改回5001
3. 重启服务

## 注意事项

1. **现有服务需要重启**：任何正在运行的5001端口服务需要停止并重新启动
2. **端口冲突检查**：确保5000端口未被其他程序占用
3. **环境变量优先**：仍然可以通过设置 `PORT` 环境变量来覆盖默认端口
4. **调试模式保持**：调试模式配置保持不变

## 影响评估

### 积极影响
- ✅ 前后端端口统一，减少配置复杂度
- ✅ 避免端口不一致导致的连接问题
- ✅ 简化部署和维护

### 潜在影响
- ⚠️ 需要重启所有相关服务
- ⚠️ 可能需要更新相关的防火墙或网络配置
- ⚠️ 现有的书签或快捷方式可能需要更新

---
**变更时间**: 2026-02-15
**变更版本**: 2.0
**审核状态**: 待确认