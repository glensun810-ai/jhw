# 日志轮转配置
# 用于防止日志文件过大，自动归档旧日志

# 应用日志
logs/app.log {
    daily                    # 每天轮转
    rotate 7                 # 保留 7 个备份
    compress                 # 压缩旧日志
    delaycompress            # 延迟一天压缩
    missingok                # 日志文件不存在不报错
    notifempty               # 空日志不轮转
    create 644 www-data www-data  # 创建新文件的权限
    dateext                  # 使用日期作为扩展名
    dateformat -%Y%m%d       # 日期格式
    postrotate
        # 轮转后重新加载日志（如果需要）
        # kill -HUP `cat /var/run/app.pid`
    endscript
}

# 监控日志
logs/monitoring.log {
    daily
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 644 www-data www-data
    dateext
    dateformat -%Y%m%d
}

# 错误日志
logs/error.log {
    weekly                   # 每周轮转
    rotate 4                 # 保留 4 个备份
    compress
    delaycompress
    missingok
    notifempty
    create 644 www-data www-data
    dateext
    dateformat -%Y%m%d
    minsize 1M               # 最小 1MB 才轮转
}
