# 环境变量示例文件
# 请复制此文件为 .env 并填入真实的 API 密钥
# 确保 .env 文件已被添加到 .gitignore 中

# ==================== AI Platform API Keys ====================
DEEPSEEK_API_KEY="your-deepseek-api-key-here"
JUDGE_LLM_API_KEY="your-judge-llm-api-key-here"
QWEN_API_KEY="your-qwen-api-key-here"
DOUBAO_API_KEY="your-doubao-api-key-here"
CHATGPT_API_KEY="your-chatgpt-api-key-here"
GEMINI_API_KEY="your-gemini-api-key-here"
ZHIPU_API_KEY="your-zhipu-api-key-here"

# ==================== 微信小程序配置 ====================
WECHAT_APP_ID="your-wechat-app-id"
WECHAT_APP_SECRET="your-wechat-app-secret"
WECHAT_TOKEN="your-wechat-token"

# ==================== Flask 配置 ====================
SECRET_KEY="your-secret-key-here"
PORT=5001  # 使用 5001 端口（5000 可能被 macOS Control Center 占用）
FLASK_ENV=development
FLASK_DEBUG=1

# ==================== 数据加密配置 (P0-3 敏感数据加密) ====================
# 生成新密钥：python backend_python/wechat_backend/security/data_encryption.py
ENCRYPTION_KEY="your-32-byte-base64-encoded-key-here"

# ==================== 前端配置说明 ====================
# 前端配置在 utils/config.js 中
# 开发环境默认使用 http://127.0.0.1:5001
# 确保前后端端口一致

# ==================== P2-021 告警通知配置 ====================
# 启用告警系统（true/false）
ALERT_ENABLED=true

# 钉钉机器人 Webhook URL
# 获取方式：钉钉群机器人 -> 设置 -> 自定义 -> 添加机器人 -> 复制 Webhook 地址
ALERT_DINGTALK_WEBHOOK="https://oapi.dingtalk.com/robot/send?access_token=your-access-token"

# 邮件告警接收者（逗号分隔多个邮箱）
ALERT_EMAIL_RECIPIENTS="admin@example.com,ops@example.com"

# SMTP 邮件服务器配置
SMTP_SERVER="smtp.example.com"
SMTP_PORT=587
SMTP_USER="your-smtp-username"
SMTP_PASSWORD="your-smtp-password"
SENDER_EMAIL="noreply@example.com"

# ==================== P2-020 监控配置 ====================
# 监控数据保留天数
METRICS_RETENTION_DAYS=30

# 监控 API 基础地址（前端使用）
API_BASE_URL=http://localhost:5001

# 告警阈值配置
# 数据库持久化错误阈值（连续失败次数）
PERSISTENCE_ERROR_THRESHOLD=10
# 告警时间窗口（秒）
PERSISTENCE_ERROR_WINDOW=300

# 诊断成功率阈值（%）
SUCCESS_RATE_MIN=95.0
# 平均完成率阈值（%）
COMPLETION_RATE_MIN=90.0
# 配额用尽率阈值（%）
QUOTA_EXHAUSTED_MAX=20.0
# 平均耗时阈值（秒）
AVG_DURATION_MAX=120.0
# 错误率阈值（%）
ERROR_RATE_MAX=10.0

# 监控检查间隔（秒）
CHECK_INTERVAL=300
# 告警冷却时间（秒）
ALERT_COOLDOWN=1800

# ==================== 生产环境配置 ====================
# 生产环境日志级别（INFO/WARNING/ERROR）
LOG_LEVEL=INFO
# 日志文件路径
LOG_FILE=logs/app.log
# 日志文件最大大小（字节）
LOG_MAX_BYTES=10485760
# 日志文件备份数量
LOG_BACKUP_COUNT=5

# ==================== P2-5 CDN 加速配置 ====================
# 是否启用 CDN 加速（true/false）
CDN_ENABLED=false

# CDN 域名（替换为你的实际 CDN 域名）
CDN_DOMAIN=cdn.example.com

# CDN 协议（http 或 https）
CDN_PROTOCOL=https

# 静态资源版本号（用于缓存失效）
STATIC_VERSION=v2.0.0

# 静态资源缓存时间（秒，默认 30 天）
STATIC_CACHE_MAX_AGE=2592000

# HTML 文件缓存时间（秒，默认 1 小时）
HTML_CACHE_MAX_AGE=3600

# API 响应缓存时间（秒，默认 5 分钟）
API_CACHE_MAX_AGE=300

# 报告文件缓存时间（秒，默认 1 天）
REPORT_CACHE_MAX_AGE=86400

# ==================== P2-5 OSS 对象存储配置 ====================
# OSS 提供商（aliyun, tencent, qiniu）
OSS_PROVIDER=aliyun

# OSS 访问密钥
OSS_ACCESS_KEY_ID=your-oss-access-key-id
OSS_ACCESS_KEY_SECRET=your-oss-access-key-secret

# OSS 存储桶配置
OSS_BUCKET_NAME=your-bucket-name
OSS_BUCKET_REGION=oss-cn-hangzhou

# OSS 端点
OSS_ENDPOINT=oss-cn-hangzhou.aliyuncs.com

# OSS CDN 域名（用于加速文件访问）
OSS_CDN_DOMAIN=cdn-oss.example.com

# 报告文件存储类型（local 或 oss）
REPORT_STORAGE_TYPE=local

# 本地报告存储目录
REPORT_STORAGE_DIR=reports

# OSS 报告存储路径前缀
REPORT_OSS_PREFIX=diagnosis-reports

# ==================== CDN 缓存控制配置 ====================
# 是否启用缓存控制头（true/false）
CACHE_CONTROL_ENABLED=true

# 缓存控制头类型（public, private, no-cache, no-store）
CACHE_CONTROL_TYPE=public

# ==================== CDN 资源预加载配置 ====================
# 是否启用资源预加载（true/false）
PRELOAD_ENABLED=false

# ==================== P2-6 数据库读写分离配置 ====================
# 是否启用读写分离（true/false）
READ_WRITE_SPLITTING_ENABLED=false

# 主数据库路径
MASTER_DB_PATH=/path/to/master.db

# 主数据库最大连接数
MASTER_DB_MAX_CONNECTIONS=5

# 主数据库超时时间（秒）
MASTER_DB_TIMEOUT=30.0

# 从数据库路径列表（逗号分隔）
SLAVE_DB_PATHS=/path/to/slave1.db,/path/to/slave2.db

# 从数据库最大连接数（每个从库）
SLAVE_DB_MAX_CONNECTIONS=10

# 从数据库超时时间（秒）
SLAVE_DB_TIMEOUT=30.0

# 路由策略（round_robin, random, least_connections, priority）
ROUTE_STRATEGY=round_robin

# 从库优先级列表（用于 priority 策略，逗号分隔）
SLAVE_PRIORITY=/path/to/slave1.db,/path/to/slave2.db

# ==================== P2-6 数据库复制监控配置 ====================
# 复制延迟检查间隔（秒）
REPLICATION_LAG_CHECK_INTERVAL=60

# 最大允许复制延迟（秒）
MAX_REPLICATION_LAG=5.0

# 复制延迟告警阈值（秒）
REPLICATION_LAG_ALERT_THRESHOLD=10.0

# 是否启用故障转移（true/false）
FAILOVER_ENABLED=true

# 从库健康检查间隔（秒）
SLAVE_HEALTH_CHECK_INTERVAL=30

# 连续失败次数阈值（超过则标记为不可用）
SLAVE_FAILURE_THRESHOLD=3

# 从库恢复检查间隔（秒）
SLAVE_RECOVERY_CHECK_INTERVAL=60

# ==================== P2-6 写后读一致性配置 ====================
# 写操作后是否立即从主库读取（保证一致性）
READ_AFTER_WRITE_FROM_MASTER=true

# 写操作后从主库读取的时间窗口（秒）
READ_AFTER_WRITE_WINDOW=5.0

# 默认数据库路径（兼容模式，未配置主从时使用）
DEFAULT_DB_PATH=database.db

# 默认数据库最大连接数
DEFAULT_DB_MAX_CONNECTIONS=10

# ==================== P2-7 智能缓存预热配置 ====================
# 是否启用缓存预热（true/false）
CACHE_WARMUP_ENABLED=true

# 是否启用自动预热（系统启动时自动预热）
AUTO_WARMUP_ON_STARTUP=true

# 是否启用定时预热
SCHEDULED_WARMUP_ENABLED=true

# 定时预热时间（cron 表达式：分 时 日 月 周）
# 默认：每天凌晨 3 点执行
WARMUP_SCHEDULE=0 3 * * *

# 定时预热间隔（分钟，用于简单间隔模式）
WARMUP_INTERVAL_MINUTES=60

# 预热热门品牌数量
WARMUP_POPULAR_BRANDS_COUNT=20

# 预热热门用户数量
WARMUP_POPULAR_USERS_COUNT=50

# 预热热门问题数量
WARMUP_POPULAR_QUESTIONS_COUNT=20

# 预热诊断报告数量（最近的报告）
WARMUP_RECENT_REPORTS_COUNT=100

# 品牌统计缓存时间（秒）
BRAND_STATS_TTL=3600

# 用户统计缓存时间（秒）
USER_STATS_TTL=1800

# 问题统计缓存时间（秒）
QUESTION_STATS_TTL=3600

# 诊断报告缓存时间（秒）
REPORT_STATS_TTL=900

# API 响应缓存时间（秒）
API_RESPONSE_TTL=300

# 预热优先级（逗号分隔）
WARMUP_PRIORITY=popular_brands,recent_reports,popular_questions,user_stats,api_responses

# 是否启用并发预热
CONCURRENT_WARMUP_ENABLED=true

# 并发预热线程数
WARMUP_THREAD_COUNT=4

# 是否启用详细日志
WARMUP_VERBOSE_LOGGING=false

# 预热超时时间（秒）
WARMUP_TIMEOUT_SECONDS=300
