<!--pages/report/source-graph/detail.wxml-->
<!-- ä¿¡æºå›¾è°±è¯¦æƒ…é¡µ -->
<view class="container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¿¡æºæ•°æ®ä¸­...</text>
  </view>

  <!-- æ•°æ®å†…å®¹ -->
  <view wx:elif="{{!loading && sourceData}}" class="content-wrapper">
    <!-- é¡µé¢å¤´éƒ¨ -->
    <view class="page-header">
      <text class="page-title">ä¿¡æºå›¾è°±åˆ†æ</text>
      <text class="page-subtitle">{{brandName}}</text>
    </view>

    <!-- ä¿¡æºæ¦‚è§ˆ -->
    <view class="overview-card">
      <view class="card-header">
        <text class="card-title">ä¿¡æºæ¦‚è§ˆ</text>
      </view>
      <view class="overview-grid">
        <view class="overview-item">
          <view class="overview-value">{{totalSources}}</view>
          <view class="overview-label">æ€»ä¿¡æºæ•°</view>
        </view>
        <view class="overview-item">
          <view class="overview-value">{{citedSources}}</view>
          <view class="overview-label">è¢«å¼•ç”¨ä¿¡æº</view>
        </view>
        <view class="overview-item">
          <view class="overview-value">{{citationRate}}%</view>
          <view class="overview-label">å¼•ç”¨ç‡</view>
        </view>
      </view>
    </view>

    <!-- ä¿¡æºå¼•ç”¨æ’å -->
    <view class="sources-card">
      <view class="card-header">
        <text class="card-title">ä¿¡æºå¼•ç”¨æ’å</text>
        <text class="card-subtitle">Top 10</text>
      </view>
      <view class="source-list">
        <view class="source-item" wx:for="{{sourceRanking}}" wx:key="rank" wx:for-item="source">
          <view class="source-rank">{{source.rank}}</view>
          <view class="source-info">
            <view class="source-name">{{source.name}}</view>
            <view class="source-domain">{{source.domain}}</view>
          </view>
          <view class="source-stats">
            <view class="source-citations">{{source.citations}} æ¬¡å¼•ç”¨</view>
            <view class="source-percentage">{{source.percentage}}%</view>
          </view>
        </view>
      </view>
    </view>

    <!-- ä¿¡æºç±»å‹åˆ†å¸ƒ -->
    <view class="sources-card" wx:if="{{sourceTypes && sourceTypes.length > 0}}">
      <view class="card-header">
        <text class="card-title">ä¿¡æºç±»å‹åˆ†å¸ƒ</text>
      </view>
      <view class="type-list">
        <view class="type-item" wx:for="{{sourceTypes}}" wx:key="type" wx:for-item="typeItem">
          <view class="type-label">{{typeItem.type}}</view>
          <view class="type-bar">
            <view class="type-bar-fill" style="width: {{typeItem.percentage}}%;"></view>
          </view>
          <view class="type-value">{{typeItem.count}} ({{typeItem.percentage}}%)</view>
        </view>
      </view>
    </view>

    <!-- å¯ä¿¡åº¦åˆ†æ -->
    <view class="sources-card" wx:if="{{credibilityData}}">
      <view class="card-header">
        <text class="card-title">ä¿¡æºå¯ä¿¡åº¦åˆ†æ</text>
      </view>
      <view class="credibility-grid">
        <view class="credibility-item">
          <view class="credibility-label">é«˜å¯ä¿¡åº¦</view>
          <view class="credibility-value high">{{credibilityData.high}}</view>
        </view>
        <view class="credibility-item">
          <view class="credibility-label">ä¸­å¯ä¿¡åº¦</view>
          <view class="credibility-value medium">{{credibilityData.medium}}</view>
        </view>
        <view class="credibility-item">
          <view class="credibility-label">ä½å¯ä¿¡åº¦</view>
          <view class="credibility-value low">{{credibilityData.low}}</view>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:else class="empty-state">
    <text class="empty-icon">ğŸ“Š</text>
    <text class="empty-text">æš‚æ— ä¿¡æºæ•°æ®</text>
  </view>
</view>
