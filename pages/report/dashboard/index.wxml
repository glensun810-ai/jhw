<!-- GEO å“ç‰Œæˆ˜ç•¥è¯Šæ–­çœ‹æ¿ - éº¦è‚¯é”¡ä¸‰æ®µå¼å¸ƒå±€ -->
<view class="container" wx:if="{{dashboardData}}">
  <!-- ç¬¬ä¸€æ®µï¼šæ¦‚è§ˆè¯„åˆ†å¡ç‰‡ -->
  <view class="header-card">
    <view class="brand-title">{{dashboardData.summary.brandName}} Â· GEO å“ç‰Œè¯Šæ–­æŠ¥å‘Š</view>
    
    <view class="score-section">
      <view class="score-box">
        <text class="score-label">å“ç‰Œå¥åº·åº¦å¾—åˆ†</text>
        <text class="score-value {{dashboardData.summary.healthScore >= 80 ? 'excellent' : dashboardData.summary.healthScore >= 60 ? 'good' : 'warning'}}">{{dashboardData.summary.healthScore}}</text>
        <text class="score-unit">åˆ†</text>
      </view>
      
      <view class="metrics-row">
        <view class="metric-item">
          <view class="metric-value">{{dashboardData.summary.sov}}%</view>
          <view class="metric-label">AI å£°é‡å æ¯”</view>
          <view class="metric-sub">{{dashboardData.summary.totalMentions}}/{{dashboardData.summary.totalTests}} æåŠ</view>
        </view>
        <view class="metric-divider"></view>
        <view class="metric-item">
          <view class="metric-value {{parseFloat(dashboardData.summary.avgSentiment) >= 0.3 ? 'positive' : parseFloat(dashboardData.summary.avgSentiment) <= -0.3 ? 'negative' : ''}}">{{dashboardData.summary.avgSentiment}}</view>
          <view class="metric-label">æƒ…æ„Ÿå‡å€¼</view>
          <view class="metric-sub">-1 åˆ° 1 åŒºé—´</view>
        </view>
      </view>
    </view>
  </view>

  <!-- ç¬¬äºŒæ®µï¼šæ ¸å¿ƒé—®é¢˜è¯Šæ–­åˆ†æ -->
  <view class="section">
    <view class="section-header">
      <view class="section-title">
        <text class="title-icon">ğŸ“Š</text>
        <text class="title-text">æ ¸å¿ƒé—®é¢˜è¯Šæ–­åˆ†æ</text>
      </view>
      <view class="section-subtitle">å…± {{questionCards.length}} ä¸ªé—®é¢˜</view>
    </view>
    
    <view class="question-list">
      <block wx:for="{{questionCards}}" wx:key="index">
        <view class="question-card {{item.status}}" bindtap="goToQuestionDetail" data-index="{{index}}">
          <view class="q-header">
            <view class="q-number">Q{{index + 1}}</view>
            <text class="q-text">{{item.text}}</text>
          </view>
          
          <view class="q-body">
            <view class="q-metrics">
              <view class="q-metric">
                <text class="q-metric-label">å¹³å‡æ’å</text>
                <text class="q-metric-value {{item.avgRank === 'æœªå…¥æ¦œ' ? 'unranked' : ''}}">{{item.avgRank}}</text>
              </view>
              <view class="q-metric">
                <text class="q-metric-label">æåŠç‡</text>
                <text class="q-metric-value">{{item.mentionCount}}/{{item.totalModels}}</text>
              </view>
              <view class="q-metric">
                <text class="q-metric-label">æƒ…æ„Ÿ</text>
                <text class="q-metric-value {{parseFloat(item.avgSentiment) >= 0.3 ? 'positive' : parseFloat(item.avgSentiment) <= -0.3 ? 'negative' : ''}}">{{item.avgSentiment}}</text>
              </view>
            </view>
            
            <view class="q-status {{item.status}}">
              <text class="status-icon">{{item.status === 'safe' ? 'âœ…' : 'âš ï¸'}}</text>
              <text class="status-text">{{item.status === 'safe' ? 'å®‰å…¨' : 'é£é™©'}}</text>
            </view>
          </view>
          
          <view class="q-footer" wx:if="{{item.interceptedBy.length > 0}}">
            <view class="warning-banner">
              <text class="warning-icon">âš ï¸</text>
              <text class="warning-text">è¢«ç«å“æ‹¦æˆªï¼š<text class="warning-brand">{{item.interceptedBy}}</text></text>
            </view>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- ç¬¬ä¸‰æ®µï¼šé«˜é£é™©è´Ÿé¢ä¿¡æº -->
  <view class="section" wx:if="{{toxicSources && toxicSources.length > 0}}">
    <view class="section-header">
      <view class="section-title">
        <text class="title-icon">ğŸš¨</text>
        <text class="title-text">é«˜é£é™©è´Ÿé¢ä¿¡æº</text>
      </view>
      <view class="section-subtitle">å…± {{toxicSources.length}} ä¸ªå±é™©ä¿¡æº</view>
    </view>
    
    <view class="toxic-sources-list">
      <block wx:for="{{toxicSources}}" wx:key="url">
        <view class="toxic-source-card">
          <view class="ts-header">
            <view class="ts-site">{{item.site}}</view>
            <view class="ts-tag negative">è´Ÿé¢</view>
          </view>
          <view class="ts-url">{{item.url}}</view>
          <view class="ts-footer">
            <text class="ts-model">æ£€æµ‹æ¨¡å‹ï¼š{{item.model}}</text>
            <text class="ts-impact">å½±å“æ’å</text>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€æç¤º -->
  <view class="empty-state" wx:if="{{!toxicSources || toxicSources.length === 0}}">
    <view class="empty-icon">âœ…</view>
    <view class="empty-text">æœªå‘ç°é«˜é£é™©è´Ÿé¢ä¿¡æº</view>
    <view class="empty-sub">å“ç‰Œå£°èª‰çŠ¶å†µè‰¯å¥½</view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view class="bottom-bar">
    <button class="btn-secondary" bindtap="viewHistory">ğŸ“‹ å†å²è®°å½•</button>
    <button class="btn-primary" bindtap="exportReport">å¯¼å‡ºæŠ¥å‘Š</button>
  </view>
</view>

<!-- åŠ è½½ä¸­çŠ¶æ€ -->
<view class="loading-container" wx:if="{{!dashboardData && !loadError}}">
  <view class="loading-spinner"></view>
  <view class="loading-text">æ­£åœ¨ç”Ÿæˆæˆ˜ç•¥çœ‹æ¿...</view>
</view>

<!-- é”™è¯¯çŠ¶æ€ -->
<view class="error-container" wx:if="{{loadError}}">
  <view class="error-icon">âš ï¸</view>
  <view class="error-text">{{loadError}}</view>
  <button class="btn-retry" bindtap="retry">é‡æ–°åŠ è½½</button>
</view>
