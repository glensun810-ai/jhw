<!-- åŸå§‹æ•°æ®è¯¦æƒ…é¡µ - P0 çº§ç©ºç¼ºä¿®å¤ -->
<view class="container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½åŸå§‹æ•°æ®ä¸­...</text>
  </view>

  <!-- æ•°æ®å†…å®¹ -->
  <view wx:else-if="{{!loading && rawData}}" class="content-wrapper">
    <!-- é¡¶éƒ¨æ‘˜è¦å¡ç‰‡ -->
    <view class="summary-card">
      <view class="summary-header">
        <text class="summary-title">æ•°æ®æ‘˜è¦</text>
        <text class="summary-subtitle">{{executionId}}</text>
      </view>
      
      <view class="summary-grid">
        <view class="summary-item">
          <view class="summary-value number-font">
            <count-up end="{{summary.totalRecords}}" duration="1000"></count-up>
          </view>
          <view class="summary-label">æ€»è®°å½•æ•°</view>
        </view>
        
        <view class="summary-item">
          <view class="summary-value number-font">
            <count-up end="{{summary.totalBrands}}" duration="1000"></count-up>
          </view>
          <view class="summary-label">å“ç‰Œæ•°é‡</view>
        </view>
        
        <view class="summary-item">
          <view class="summary-value number-font">
            <count-up end="{{summary.totalQuestions}}" duration="1000"></count-up>
          </view>
          <view class="summary-label">é—®é¢˜æ•°é‡</view>
        </view>
        
        <view class="summary-item">
          <view class="summary-value number-font">
            <count-up end="{{summary.totalModels}}" duration="1000"></count-up>
          </view>
          <view class="summary-label">AI æ¨¡å‹æ•°</view>
        </view>
      </view>
    </view>

    <!-- æ•°æ®ç­›é€‰æ  -->
    <view class="filter-bar">
      <view class="filter-group">
        <view 
          class="filter-item {{currentFilter === 'all' ? 'active' : ''}}"
          bindtap="onFilterTap"
          data-filter="all"
        >
          å…¨éƒ¨
        </view>
        <view 
          class="filter-item {{currentFilter === 'brand' ? 'active' : ''}}"
          bindtap="onFilterTap"
          data-filter="brand"
        >
          æŒ‰å“ç‰Œ
        </view>
        <view 
          class="filter-item {{currentFilter === 'model' ? 'active' : ''}}"
          bindtap="onFilterTap"
          data-filter="model"
        >
          æŒ‰æ¨¡å‹
        </view>
        <view 
          class="filter-item {{currentFilter === 'question' ? 'active' : ''}}"
          bindtap="onFilterTap"
          data-filter="question"
        >
          æŒ‰é—®é¢˜
        </view>
      </view>
      
      <view class="sort-group">
        <view class="sort-btn" bindtap="toggleSortOrder">
          <text>{{sortOrder === 'desc' ? 'â†“' : 'â†‘'}}</text>
          <text>æ—¶é—´æ’åº</text>
        </view>
      </view>
    </view>

    <!-- æ•°æ®åˆ—è¡¨ -->
    <view class="data-list">
      <view 
        class="data-item"
        wx:for="{{filteredData}}"
        wx:key="id"
        bindtap="onItemTap"
        data-item="{{item}}"
      >
        <view class="data-item-header">
          <view class="data-item-brand">{{item.brand}}</view>
          <view class="data-item-model">{{item.model}}</view>
        </view>
        
        <view class="data-item-content">
          <view class="data-item-question">
            <text class="label">é—®é¢˜ï¼š</text>
            <text class="text">{{item.question}}</text>
          </view>
          
          <view class="data-item-response">
            <text class="label">å›ç­”ï¼š</text>
            <view class="response-text">{{item.response}}</view>
          </view>
        </view>
        
        <view class="data-item-footer">
          <view class="data-item-meta">
            <text class="meta-item">
              <text class="meta-icon">ğŸ“Š</text>
              <text>æ’åï¼š{{item.rank || '-'}}</text>
            </text>
            <text class="meta-item">
              <text class="meta-icon">ğŸ’</text>
              <text>æƒ…æ„Ÿï¼š{{item.sentiment || '-'}}</text>
            </text>
          </view>
          
          <view class="data-item-time">{{formatTime(item.timestamp)}}</view>
        </view>
        
        <view class="expand-indicator {{item.expanded ? 'expanded' : ''}}">
          <text>â€º</text>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:if="{{filteredData.length === 0}}" class="empty-state">
      <text class="empty-icon">ğŸ“­</text>
      <text class="empty-text">æš‚æ— æ•°æ®</text>
    </view>
  </view>

  <!-- é”™è¯¯çŠ¶æ€ -->
  <view wx:if="{{error}}" class="error-container">
    <text class="error-icon">âš ï¸</text>
    <text class="error-text">{{error}}</text>
    <button class="retry-btn" bindtap="retry">é‡æ–°åŠ è½½</button>
  </view>
</view>
