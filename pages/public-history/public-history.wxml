<view class="container">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="page-header">
    <text class="page-title">å…¬å…±å†å²è®°å½•</text>
    <text class="page-subtitle">æŸ¥çœ‹å…¬å¼€çš„å“ç‰Œè®¤çŸ¥è¯Šæ–­è®°å½•</text>
  </view>

  <!-- æœç´¢å’Œç­›é€‰ -->
  <view class="search-filter-section">
    <view class="search-bar">
      <input class="search-input" placeholder="æœç´¢å“ç‰Œåç§°..." value="{{searchKeyword}}" bindinput="onSearchInput" />
      <button class="search-btn" bindtap="onSearch">æœç´¢</button>
    </view>
    <view class="filter-bar">
      <view class="filter-item" bindtap="showTimeFilter">
        <text>{{timeRangeText}}</text>
        <text class="arrow">â–¼</text>
      </view>
      <view class="filter-item" bindtap="showScoreFilter">
        <text>{{scoreRangeText}}</text>
        <text class="arrow">â–¼</text>
      </view>
    </view>
  </view>

  <!-- å†å²è®°å½•åˆ—è¡¨ -->
  <view class="history-list">
    <view class="history-card" wx:for="{{filteredHistory}}" wx:key="id" bindtap="viewDetail" data-id="{{item.id}}">
      <view class="card-header">
        <text class="brand-name">{{item.brandName}}</text>
        <text class="test-time">{{formatDate(item.timestamp)}}</text>
      </view>
      <view class="card-content">
        <view class="score-display">
          <text class="score-num {{item.overallScore >= 80 ? 'text-green' : (item.overallScore >= 60 ? 'text-orange' : 'text-red')}}">
            {{item.overallScore}}
          </text>
          <text class="score-label">åˆ†</text>
        </view>
        <view class="dimension-scores">
          <text class="dimension-score">ğŸ† {{item.overallAuthority}}</text>
          <text class="dimension-score">ğŸ‘ï¸ {{item.overallVisibility}}</text>
          <text class="dimension-score">âœ¨ {{item.overallPurity}}</text>
          <text class="dimension-score">ğŸ”— {{item.overallConsistency}}</text>
        </view>
      </view>
      <view class="card-footer">
        <text class="platform-count">å¹³å°: {{item.platformCount}}ä¸ª</text>
        <text class="question-count">é—®é¢˜: {{item.questionCount}}ä¸ª</text>
      </view>
    </view>

    <view class="empty-state" wx:if="{{filteredHistory.length === 0}}">
      <text>æš‚æ— å…¬å…±å†å²è®°å½•</text>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{isLoading}}">
    <text>æ­£åœ¨åŠ è½½...</text>
  </view>

  <!-- ç™»å½•æç¤º -->
  <login-prompt prompt-text="ç™»å½•åå¯æŸ¥çœ‹ä¸ªäººå†å²è®°å½•" buttonText="ç™»å½•æŸ¥çœ‹" />

  <!-- æ—¶é—´ç­›é€‰å¼¹çª— -->
  <view class="modal-overlay" wx:if="{{showTimeFilterModal}}">
    <view class="modal-content">
      <view class="modal-header">
        <text>é€‰æ‹©æ—¶é—´èŒƒå›´</text>
        <text class="close-btn" bindtap="hideTimeFilter">âœ•</text>
      </view>
      <view class="modal-body">
        <view class="time-option" wx:for="{{timeOptions}}" wx:key="value" bindtap="selectTimeOption" data-value="{{item.value}}">
          <text>{{item.label}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- åˆ†æ•°ç­›é€‰å¼¹çª— -->
  <view class="modal-overlay" wx:if="{{showScoreFilterModal}}">
    <view class="modal-content">
      <view class="modal-header">
        <text>é€‰æ‹©åˆ†æ•°èŒƒå›´</text>
        <text class="close-btn" bindtap="hideScoreFilter">âœ•</text>
      </view>
      <view class="modal-body">
        <view class="score-range-selector">
          <slider class="score-slider" min="0" max="100" value="{{scoreRange[0]}}" bindchange="onMinScoreChange" />
          <text class="score-range-text">æœ€ä½åˆ†: {{scoreRange[0]}} - æœ€é«˜åˆ†: {{scoreRange[1]}}</text>
          <slider class="score-slider" min="0" max="100" value="{{scoreRange[1]}}" bindchange="onMaxScoreChange" />
        </view>
        <button class="apply-btn" bindtap="applyScoreFilter">åº”ç”¨ç­›é€‰</button>
      </view>
    </view>
  </view>
</view>