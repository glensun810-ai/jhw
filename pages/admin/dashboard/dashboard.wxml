<!--pages/admin/dashboard/dashboard.wxml-->
<!-- ç®¡ç†å‘˜ä»ªè¡¨ç›˜ -->
<view class="admin-container">
  <!-- å¤´éƒ¨ -->
  <view class="admin-header">
    <text class="admin-title">ç®¡ç†åå°</text>
    <text class="admin-subtitle">ç³»ç»Ÿç›‘æ§ä¸ç®¡ç†</text>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- æ•°æ®å†…å®¹ -->
  <view wx:else class="content-wrapper">
    <!-- æ¦‚è§ˆå¡ç‰‡ -->
    <view class="overview-section">
      <view class="overview-card primary">
        <view class="card-icon">ğŸ‘¥</view>
        <view class="card-content">
          <text class="card-value">{{overview.total_users}}</text>
          <text class="card-label">æ€»ç”¨æˆ·æ•°</text>
        </view>
      </view>

      <view class="overview-card">
        <view class="card-icon">ğŸ“ˆ</view>
        <view class="card-content">
          <text class="card-value">{{overview.new_users_today}}</text>
          <text class="card-label">ä»Šæ—¥æ–°å¢</text>
        </view>
      </view>

      <view class="overview-card">
        <view class="card-icon">ğŸ“</view>
        <view class="card-content">
          <text class="card-value">{{overview.total_tests}}</text>
          <text class="card-label">æ€»æµ‹è¯•æ•°</text>
        </view>
      </view>

      <view class="overview-card">
        <view class="card-icon">âš¡</view>
        <view class="card-content">
          <text class="card-value">{{overview.tests_today}}</text>
          <text class="card-label">ä»Šæ—¥æµ‹è¯•</text>
        </view>
      </view>
    </view>

    <!-- å¾…å¤„ç†ä»»åŠ¡ -->
    <view class="section" wx:if="{{pendingTasks && pendingTasks.length > 0}}">
      <view class="section-header">
        <text class="section-title">å¾…å¤„ç†ä»»åŠ¡</text>
      </view>
      <view class="task-list">
        <view class="task-item" wx:for="{{pendingTasks}}" wx:key="stage" wx:for-item="task">
          <view class="task-stage">{{task.stage_name}}</view>
          <view class="task-count">{{task.count}}</view>
        </view>
      </view>
    </view>

    <!-- æœ€è¿‘æ´»åŠ¨ -->
    <view class="section">
      <view class="section-header">
        <text class="section-title">æœ€è¿‘æ´»åŠ¨</text>
        <text class="section-subtitle">{{recentActivities.length}} æ¡</text>
      </view>
      <view class="activity-list">
        <view class="activity-item" wx:for="{{recentActivities}}" wx:key="index" wx:for-item="activity">
          <view class="activity-info">
            <text class="activity-brand">{{activity.brand_name}}</text>
            <text class="activity-user">ç”¨æˆ·ï¼š{{activity.user_id}}</text>
          </view>
          <view class="activity-meta">
            <text class="activity-score">è¯„åˆ†ï¼š{{activity.overall_score}}</text>
            <text class="activity-time">{{formatDate(activity.test_date)}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- åŠŸèƒ½å…¥å£ -->
    <view class="function-grid">
      <view class="function-item" bindtap="navigateTo" data-url="/pages/admin/users/users">
        <view class="function-icon">ğŸ‘¤</view>
        <text class="function-label">ç”¨æˆ·ç®¡ç†</text>
      </view>
      <view class="function-item" bindtap="navigateTo" data-url="/pages/admin/tests/tests">
        <view class="function-icon">ğŸ“Š</view>
        <text class="function-label">æµ‹è¯•è®°å½•</text>
      </view>
      <view class="function-item" bindtap="navigateTo" data-url="/pages/admin/system/system">
        <view class="function-icon">âš™ï¸</view>
        <text class="function-label">ç³»ç»Ÿç›‘æ§</text>
      </view>
      <view class="function-item" bindtap="navigateTo" data-url="/pages/admin/logs/logs">
        <view class="function-icon">ğŸ“‹</view>
        <text class="function-label">æ—¥å¿—æŸ¥çœ‹</text>
      </view>
    </view>
  </view>
</view>
