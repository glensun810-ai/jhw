<!-- 情报流水线主组件模板 -->
<view class="intelligence-pipeline {{collapsed ? 'collapsed' : ''}}">
  <!-- 头部 -->
  <view class="pipeline-header" bindtap="toggleCollapse">
    <view class="header-title">
      <text>📡 情报流水线</text>
      <text wx:if="{{isLive}}" class="live-badge">实时</text>
    </view>
    <view class="header-action">
      <text>{{collapsed ? '展开' : '收起'}}</text>
    </view>
  </view>

  <!-- 内容区域 -->
  <view wx:if="{{!collapsed}}" class="pipeline-content">
    <!-- 进度指示器 -->
    <pipeline-progress
      totalCount="{{totalCount}}"
      successCount="{{successCount}}"
      processingCount="{{processingCount}}"
      errorCount="{{errorCount}}"
      pendingCount="{{pendingCount}}"
      sseConnected="{{sseConnected}}"
      sseConnecting="{{sseConnecting}}"
      sseError="{{sseError}}"
      bind:progresschange="onProgressChange"
      bind:refresh="onRefresh"
    />

    <!-- 流水线列表 -->
    <scroll-view 
      class="pipeline-list" 
      scroll-y 
      scroll-top="{{scrollTop}}"
      enhanced
    >
      <view wx:if="{{isLoading}}" class="loading-state">
        <view class="loading-spinner"></view>
        <text>正在获取情报...</text>
      </view>

      <view wx:elif="{{items.length === 0}}" class="empty-state">
        <text>暂无情报</text>
      </view>

      <view wx:else>
        <pipeline-stage
          wx:for="{{items}}"
          wx:key="id"
          item="{{item}}"
          index="{{index}}"
          statusText="{{statusText}}"
          bind:expand="onStageExpand"
          bind:viewdetails="onViewDetails"
        />
      </view>
    </scroll-view>
  </view>
</view>
