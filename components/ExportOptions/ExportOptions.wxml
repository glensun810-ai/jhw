<!--
  å¯¼å‡ºé€‰é¡¹ç»„ä»¶
  ç‰ˆæœ¬ï¼šv2.0
-->
<view class="export-overlay {{visible ? 'visible' : ''}}" bindtap="onCancel"></view>

<view class="export-container {{visible ? 'visible' : ''}}">
  <!-- å¤´éƒ¨ -->
  <view class="export-header">
    <view class="export-title">å¯¼å‡ºè¯Šæ–­æŠ¥å‘Š</view>
    <view class="export-subtitle">{{brandName}}</view>
    <view class="export-close" bindtap="onCancel">âœ•</view>
  </view>

  <!-- å†…å®¹åŒºåŸŸ -->
  <scroll-view class="export-content" scroll-y>
    
    <!-- å¯¼å‡ºæ ¼å¼ -->
    <view class="export-section">
      <view class="section-title">å¯¼å‡ºæ ¼å¼</view>
      <view class="format-options">
        <view 
          class="format-option {{format === 'pdf' ? 'selected' : ''}}"
          data-format="pdf"
          bindtap="onFormatChange"
        >
          <view class="format-icon">ğŸ“„</view>
          <view class="format-label">PDF</view>
        </view>
        <view 
          class="format-option {{format === 'html' ? 'selected' : ''}}"
          data-format="html"
          bindtap="onFormatChange"
        >
          <view class="format-icon">ğŸŒ</view>
          <view class="format-label">HTML</view>
        </view>
        <view 
          class="format-option {{format === 'excel' ? 'selected' : ''}}"
          data-format="excel"
          bindtap="onFormatChange"
        >
          <view class="format-icon">ğŸ“Š</view>
          <view class="format-label">Excel</view>
        </view>
      </view>
    </view>

    <!-- æŠ¥å‘Šçº§åˆ« -->
    <view class="export-section">
      <view class="section-title">æŠ¥å‘Šçº§åˆ«</view>
      <view class="level-options">
        <view 
          class="level-option {{level === item.value ? 'selected' : ''}}"
          wx:for="{{levelOptions}}"
          wx:key="value"
          data-level="{{item.value}}"
          bindtap="onLevelChange"
        >
          <view class="level-icon">{{item.icon}}</view>
          <view class="level-info">
            <view class="level-label">{{item.label}}</view>
            <view class="level-desc">{{item.desc}}</view>
          </view>
          <view class="level-radio {{level === item.value ? 'checked' : ''}}"></view>
        </view>
      </view>
    </view>

    <!-- é€‰æ‹©ç« èŠ‚ -->
    <view class="export-section">
      <view class="section-title">
        <view>é€‰æ‹©ç« èŠ‚</view>
        <view class="section-hint">ï¼ˆç°è‰²ä¸ºå¿…é€‰é¡¹ï¼‰</view>
      </view>
      <view class="section-options">
        <view 
          class="section-option {{sections[item.key] ? 'selected' : ''}} {{item.required ? 'required' : ''}}"
          wx:for="{{sectionOptions}}"
          wx:key="key"
          data-key="{{item.key}}"
          bindtap="onSectionChange"
        >
          <view class="section-icon">{{item.icon}}</view>
          <view class="section-label">{{item.label}}</view>
          <view class="section-checkbox {{sections[item.key] ? 'checked' : ''}}"></view>
        </view>
      </view>
    </view>

    <!-- å¼‚æ­¥ç”Ÿæˆé€‰é¡¹ -->
    <view class="export-section" wx:if="{{format === 'pdf' && level === 'full'}}">
      <view class="async-option">
        <view class="async-info">
          <view class="async-title">å¼‚æ­¥ç”Ÿæˆ</view>
          <view class="async-desc">å®Œæ•´æŠ¥å‘Šç”Ÿæˆæ—¶é—´è¾ƒé•¿ï¼Œå»ºè®®ä½¿ç”¨å¼‚æ­¥æ¨¡å¼</view>
        </view>
        <switch 
          class="async-switch"
          checked="{{isAsync}}"
          bindchange="onAsyncChange"
          color="#0f3460"
        />
      </view>
    </view>

    <!-- ç”Ÿæˆè¿›åº¦ -->
    <view class="export-section" wx:if="{{generating}}">
      <view class="progress-container">
        <view class="progress-title">{{statusMessage}}</view>
        <view class="progress-bar">
          <view class="progress-fill" style="width: {{progress}}%"></view>
        </view>
        <view class="progress-text">{{progress}}%</view>
      </view>
    </view>

  </scroll-view>

  <!-- åº•éƒ¨æŒ‰é’® -->
  <view class="export-footer">
    <view class="footer-info">
      <view class="info-text">é¢„è®¡ç”Ÿæˆæ—¶é—´ï¼š{{level === 'basic' ? '10 ç§’' : level === 'detailed' ? '30 ç§’' : '60 ç§’'}}</view>
    </view>
    <view class="footer-buttons">
      <button class="btn-cancel" bindtap="onCancel">å–æ¶ˆ</button>
      <button 
        class="btn-export {{generating ? 'disabled' : ''}}"
        bindtap="onExport"
        disabled="{{generating}}"
      >
        {{generating ? 'ç”Ÿæˆä¸­...' : 'å¼€å§‹å¯¼å‡º'}}
      </button>
    </view>
  </view>
</view>
