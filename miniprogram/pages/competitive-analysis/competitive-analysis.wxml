<view class="container">
  <!-- æ ‡é¢˜ -->
  <view class="title">
    <text>ğŸ” ç«äº‰åˆ†æä¸­å¿ƒ</text>
  </view>

  <!-- å“ç‰Œè¾“å…¥åŒºåŸŸ -->
  <view class="section">
    <view class="section-title">å“ç‰Œé€‰æ‹©</view>
    
    <!-- ç›®æ ‡å“ç‰Œ -->
    <view class="input-group">
      <text class="label">ç›®æ ‡å“ç‰Œ:</text>
      <input class="input" placeholder="è¯·è¾“å…¥æ‚¨çš„å“ç‰Œåç§°" value="{{targetBrand}}" bindinput="onTargetBrandInput"/>
    </view>

    <!-- ç«äº‰å¯¹æ‰‹è¾“å…¥ -->
    <view class="competitor-input-container">
      <text class="label">æ·»åŠ ç«äº‰å¯¹æ‰‹:</text>
      <view class="competitor-input-wrapper">
        <input
          class="competitor-input"
          placeholder="è¾“å…¥ç«äº‰å¯¹æ‰‹å“ç‰Œåç§°ï¼Œå›è½¦æ·»åŠ "
          value="{{currentCompetitor}}"
          bindinput="onCompetitorInput"
          bindconfirm="addCompetitor"
        />
        <button class="add-btn" bindtap="addCompetitor">+</button>
      </view>
      <view class="competitor-list">
        <view class="competitor-tag" wx:for="{{competitorBrands}}" wx:key="index">
          <text>{{item}}</text>
          <icon class="remove-icon" type="clear" size="16" bindtap="removeCompetitor" data-index="{{index}}"/>
        </view>
      </view>
    </view>
  </view>

  <!-- AIæ¨¡å‹é€‰æ‹© -->
  <view class="section">
    <view class="section-title">AIæ¨¡å‹é€‰æ‹©</view>
    
    <!-- å›½å†…AIæ¨¡å‹ -->
    <view class="ai-category">
      <text class="category-title">å›½å†…AIå¹³å°</text>
      <view class="checkbox-list">
        <view class="checkbox-item" wx:for="{{domesticAiModels}}" wx:key="index">
          <label class="checkbox-label">
            <checkbox value="{{item.name}}" checked="{{item.checked}}" bindchange="onDomesticAiModelChange" data-index="{{index}}"/>
            <text>{{item.name}}</text>
          </label>
        </view>
      </view>
    </view>

    <!-- æµ·å¤–AIæ¨¡å‹ -->
    <view class="ai-category">
      <text class="category-title">æµ·å¤–AIå¹³å°</text>
      <view class="checkbox-list">
        <view class="checkbox-item" wx:for="{{overseasAiModels}}" wx:key="index">
          <label class="checkbox-label">
            <checkbox value="{{item.name}}" checked="{{item.checked}}" bindchange="onOverseasAiModelChange" data-index="{{index}}"/>
            <text>{{item.name}}</text>
          </label>
        </view>
      </view>
    </view>
  </view>

  <!-- å¼€å§‹åˆ†ææŒ‰é’® -->
  <view class="section">
    <button class="btn-primary" bindtap="startCompetitiveAnalysis" disabled="{{isAnalyzing}}">å¼€å§‹ç«äº‰åˆ†æ</button>
  </view>

  <!-- åˆ†æè¿›åº¦ -->
  <view class="section" wx:if="{{isAnalyzing}}">
    <view class="section-title">åˆ†æè¿›åº¦</view>
    <view class="progress-container">
      <progress percent="{{analysisProgress}}" activeColor="#07c160" />
      <text class="progress-text">{{analysisProgress}}%</text>
    </view>
    <text class="analyzing-info">æ­£åœ¨è¿›è¡Œç«äº‰åˆ†æï¼Œè¯·ç¨å€™...</text>
  </view>

  <!-- ç«äº‰åˆ†æç»“æœ -->
  <view class="section" wx:if="{{analysisCompleted && competitiveAnalysis}}">
    <view class="section-title">ç«äº‰åˆ†æç»“æœ</view>
    
    <!-- å¸‚åœºä»½é¢åˆ†å¸ƒ -->
    <view class="competitive-section">
      <view class="competitive-title">å¸‚åœºä»½é¢åˆ†å¸ƒ</view>
      <view class="market-share-container">
        <view class="market-share-item" wx:for="{{marketShareList}}" wx:key="brand">
          <view class="share-brand">{{item.brand}}</view>
          <view class="share-progress">
            <progress percent="{{item.percentage}}" activeColor="{{item.brand === targetBrand ? '#07c160' : '#999'}}" />
            <text class="share-percent">{{item.percentage}}%</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æ¨èæƒé‡åˆ†æ -->
    <view class="competitive-section">
      <view class="competitive-title">æ¨èæƒé‡åˆ†æ</view>
      <view class="recommendation-container">
        <view class="recommendation-item" wx:for="{{recommendationWeightList}}" wx:key="brand">
          <view class="rec-brand">{{item.brand}}</view>
          <view class="rec-weight">
            <progress percent="{{item.weight}}" activeColor="{{item.brand === targetBrand ? '#07c160' : '#999'}}" />
            <text class="rec-percent">{{item.weight}}%</text>
          </view>
        </view>
      </view>
    </view>

    <!-- ç«äº‰æ´å¯Ÿ -->
    <view class="competitive-section">
      <view class="competitive-title">ç«äº‰æ´å¯Ÿ</view>
      <view class="insights-container">
        <view class="insight-item" wx:for="{{competitiveAnalysis.summaryInsights}}" wx:key="index">
          <text class="insight-text">{{item}}</text>
        </view>
      </view>
    </view>

    <!-- ç«å“æƒ…æŠ¥ -->
    <view class="competitive-section">
      <view class="competitive-title">ç«å“æƒ…æŠ¥</view>
      <view class="intelligence-container">
        <view class="intelligence-item" wx:for="{{intelligenceList}}" wx:key="brand">
          <view class="intel-brand">{{item.brand}}</view>
          <view class="intel-content">
            <view class="intel-section" wx:if="{{item.positiveContexts && item.positiveContexts.length > 0}}">
              <text class="intel-label">æ­£é¢æåŠ: </text>
              <text class="intel-value">{{item.positiveContexts.join(', ')}}</text>
            </view>
            <view class="intel-section" wx:if="{{item.sourceIndicators && item.sourceIndicators.length > 0}}">
              <text class="intel-label">ä¿¡æ¯æ¥æº: </text>
              <text class="intel-value">{{item.sourceIndicators.join(', ')}}</text>
            </view>
            <view class="intel-section" wx:if="{{item.comparativeStatements && item.comparativeStatements.length > 0}}">
              <text class="intel-label">å¯¹æ¯”è¯­å¥: </text>
              <text class="intel-value">{{item.comparativeStatements.join(', ')}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- è¿”å›æŒ‰é’® -->
  <view class="section transparent-bg">
    <button class="btn-primary" bindtap="goHome">è¿”å›é¦–é¡µ</button>
  </view>
</view>