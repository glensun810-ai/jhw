# æŠ¥å‘Šæ¸²æŸ“ç»„ä»¶ä½¿ç”¨æ–‡æ¡£

**ç‰ˆæœ¬**: 1.0.0
**åˆ›å»ºæ—¥æœŸ**: 2026-02-27
**ä½œè€…**: ç³»ç»Ÿæ¶æ„ç»„

---

## ç›®å½•

1. [æ¦‚è¿°](#1-æ¦‚è¿°)
2. [ç»„ä»¶åˆ—è¡¨](#2-ç»„ä»¶åˆ—è¡¨)
3. [å“ç‰Œåˆ†å¸ƒç»„ä»¶](#3-å“ç‰Œåˆ†å¸ƒç»„ä»¶)
4. [æƒ…æ„Ÿåˆ†å¸ƒç»„ä»¶](#4-æƒ…æ„Ÿåˆ†å¸ƒç»„ä»¶)
5. [å…³é”®è¯äº‘ç»„ä»¶](#5-å…³é”®è¯äº‘ç»„ä»¶)
6. [æŠ¥å‘Šæ•°æ®æœåŠ¡](#6-æŠ¥å‘Šæ•°æ®æœåŠ¡)
7. [ä½¿ç”¨ç¤ºä¾‹](#7-ä½¿ç”¨ç¤ºä¾‹)
8. [å¸¸è§é—®é¢˜](#8-å¸¸è§é—®é¢˜)

---

## 1. æ¦‚è¿°

æŠ¥å‘Šæ¸²æŸ“æ¨¡å—æ˜¯å“ç‰Œè¯Šæ–­ç³»ç»Ÿ V2 é‡æ„çš„å‰ç«¯å¯è§†åŒ–ç»„ä»¶åº“ï¼Œç”¨äºå±•ç¤º AI å¹³å°å¯¹å“ç‰Œçš„åˆ†æç»“æœã€‚

### 1.1 åŠŸèƒ½ç‰¹æ€§

- ğŸ“Š **å“ç‰Œåˆ†å¸ƒå¯è§†åŒ–**: æ”¯æŒé¥¼å›¾å’ŒæŸ±çŠ¶å›¾
- ğŸ˜Š **æƒ…æ„Ÿåˆ†æå±•ç¤º**: æ”¯æŒé¥¼å›¾å’Œç¯å½¢å›¾ï¼ŒåŒ…å«æƒ…æ„Ÿå¾—åˆ†
- â˜ï¸ **å…³é”®è¯äº‘**: æ”¯æŒè¯äº‘å’Œåˆ—è¡¨ä¸¤ç§å±•ç¤ºæ¨¡å¼
- ğŸ”„ **æ•°æ®åˆ·æ–°**: æ”¯æŒä¸‹æ‹‰åˆ·æ–°å’Œæ‰‹åŠ¨åˆ·æ–°
- ğŸ“± **å“åº”å¼è®¾è®¡**: é€‚é…ä¸åŒå±å¹•å°ºå¯¸
- ğŸ¨ **ä¸»é¢˜å®šåˆ¶**: æ”¯æŒå¤šç§é¢œè‰²æ–¹æ¡ˆ

### 1.2 æŠ€æœ¯æ ˆ

- å¾®ä¿¡å°ç¨‹åºåŸç”Ÿå¼€å‘
- Component ç»„ä»¶åŒ–æ¶æ„
- Canvas 2D ç»˜å›¾ï¼ˆå¯é€‰ï¼‰
- CSS3 åŠ¨ç”»æ•ˆæœ

### 1.3 ç›®å½•ç»“æ„

```
miniprogram/
â”œâ”€â”€ pages/
â”‚   â””â”€â”€ report-v2/
â”‚       â”œâ”€â”€ report-v2.js       # æŠ¥å‘Šé¡µé¢é€»è¾‘
â”‚       â”œâ”€â”€ report-v2.wxml     # æŠ¥å‘Šé¡µé¢ç»“æ„
â”‚       â”œâ”€â”€ report-v2.wxss     # æŠ¥å‘Šé¡µé¢æ ·å¼
â”‚       â””â”€â”€ report-v2.json     # é¡µé¢é…ç½®
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ brand-distribution/    # å“ç‰Œåˆ†å¸ƒç»„ä»¶
â”‚   â”œâ”€â”€ sentiment-chart/       # æƒ…æ„Ÿåˆ†å¸ƒç»„ä»¶
â”‚   â””â”€â”€ keyword-cloud/         # å…³é”®è¯äº‘ç»„ä»¶
â””â”€â”€ services/
    â””â”€â”€ reportService.js       # æŠ¥å‘Šæ•°æ®æœåŠ¡
```

---

## 2. ç»„ä»¶åˆ—è¡¨

| ç»„ä»¶å | è·¯å¾„ | è¯´æ˜ |
|--------|------|------|
| brand-distribution | components/brand-distribution | å“ç‰Œåˆ†å¸ƒå¯è§†åŒ– |
| sentiment-chart | components/sentiment-chart | æƒ…æ„Ÿåˆ†å¸ƒå¯è§†åŒ– |
| keyword-cloud | components/keyword-cloud | å…³é”®è¯äº‘å±•ç¤º |

---

## 3. å“ç‰Œåˆ†å¸ƒç»„ä»¶

### 3.1 ç»„ä»¶è¯´æ˜

å±•ç¤ºå„å“ç‰Œåœ¨ AI å¹³å°å›ç­”ä¸­çš„éœ²å‡ºå æ¯”ï¼Œæ”¯æŒé¥¼å›¾å’ŒæŸ±çŠ¶å›¾ä¸¤ç§å±•ç¤ºæ–¹å¼ã€‚

### 3.2 å±æ€§ (Properties)

| å±æ€§å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| distributionData | Object | `{data:{}, total_count:0, warning:null}` | å“ç‰Œåˆ†å¸ƒæ•°æ® |
| chartType | String | `'pie'` | å›¾è¡¨ç±»å‹ï¼š`pie`(é¥¼å›¾) æˆ– `bar`(æŸ±çŠ¶å›¾) |
| title | String | `'å“ç‰Œåˆ†å¸ƒ'` | ç»„ä»¶æ ‡é¢˜ |
| showLegend | Boolean | `true` | æ˜¯å¦æ˜¾ç¤ºå›¾ä¾‹ |
| showLabels | Boolean | `true` | æ˜¯å¦æ˜¾ç¤ºæ•°å€¼æ ‡ç­¾ |
| colorScheme | String | `'default'` | é¢œè‰²æ–¹æ¡ˆï¼š`default`, `vibrant`, `pastel` |

### 3.3 äº‹ä»¶ (Events)

| äº‹ä»¶å | å‚æ•° | è¯´æ˜ |
|--------|------|------|
| bind:brandTap | `{brand, value, index}` | ç‚¹å‡»å“ç‰Œé¡¹æ—¶è§¦å‘ |
| bind:brandLongPress | `{brand, value, index}` | é•¿æŒ‰å“ç‰Œé¡¹æ—¶è§¦å‘ |
| bind:chartTypeChange | `{type}` | åˆ‡æ¢å›¾è¡¨ç±»å‹æ—¶è§¦å‘ |
| bind:exportImage | `{chartType, data}` | è¯·æ±‚å¯¼å‡ºå›¾ç‰‡æ—¶è§¦å‘ |

### 3.4 æ•°æ®æ ¼å¼

```javascript
{
  data: {
    'Nike': 45.5,
    'Adidas': 30.2,
    'Puma': 24.3
  },
  total_count: 100,
  warning: null
}
```

### 3.5 ä½¿ç”¨ç¤ºä¾‹

```xml
<!-- WXML -->
<brand-distribution
  distribution-data="{{brandData}}"
  chart-type="pie"
  title="å“ç‰Œåˆ†å¸ƒ"
  show-legend="{{true}}"
  bind:brandTap="onBrandTap"
></brand-distribution>
```

```javascript
// JS
Page({
  data: {
    brandData: {
      data: { 'Nike': 45.5, 'Adidas': 30.2, 'Puma': 24.3 },
      total_count: 100,
      warning: null
    }
  },
  onBrandTap(event) {
    console.log('Brand tapped:', event.detail);
  }
});
```

---

## 4. æƒ…æ„Ÿåˆ†å¸ƒç»„ä»¶

### 4.1 ç»„ä»¶è¯´æ˜

å±•ç¤º AI å›ç­”ä¸­å¯¹å“ç‰Œçš„æƒ…æ„Ÿå€¾å‘åˆ†å¸ƒï¼ˆæ­£é¢/ä¸­æ€§/è´Ÿé¢ï¼‰ï¼Œæ”¯æŒé¥¼å›¾å’Œç¯å½¢å›¾ã€‚

### 4.2 å±æ€§ (Properties)

| å±æ€§å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| distributionData | Object | `{data:{positive:0,neutral:0,negative:0}, total_count:0}` | æƒ…æ„Ÿåˆ†å¸ƒæ•°æ® |
| chartType | String | `'donut'` | å›¾è¡¨ç±»å‹ï¼š`pie`(é¥¼å›¾) æˆ– `donut`(ç¯å½¢å›¾) |
| title | String | `'æƒ…æ„Ÿåˆ†å¸ƒ'` | ç»„ä»¶æ ‡é¢˜ |
| showCenterStat | Boolean | `true` | æ˜¯å¦æ˜¾ç¤ºä¸­å¿ƒç»Ÿè®¡ï¼ˆä»…ç¯å½¢å›¾ï¼‰ |
| showDetails | Boolean | `true` | æ˜¯å¦æ˜¾ç¤ºè¯¦ç»†æ•°æ® |

### 4.3 äº‹ä»¶ (Events)

| äº‹ä»¶å | å‚æ•° | è¯´æ˜ |
|--------|------|------|
| bind:sentimentTap | `{sentiment, name, value, index}` | ç‚¹å‡»æƒ…æ„Ÿé¡¹æ—¶è§¦å‘ |
| bind:chartTypeChange | `{type}` | åˆ‡æ¢å›¾è¡¨ç±»å‹æ—¶è§¦å‘ |

### 4.4 æ•°æ®æ ¼å¼

```javascript
{
  data: {
    positive: 60.0,
    neutral: 25.0,
    negative: 15.0
  },
  total_count: 100,
  warning: null
}
```

### 4.5 ä½¿ç”¨ç¤ºä¾‹

```xml
<!-- WXML -->
<sentiment-chart
  distribution-data="{{sentimentData}}"
  chart-type="donut"
  title="æƒ…æ„Ÿåˆ†å¸ƒ"
  show-center-stat="{{true}}"
  bind:sentimentTap="onSentimentTap"
></sentiment-chart>
```

```javascript
// JS
Page({
  data: {
    sentimentData: {
      data: { positive: 60, neutral: 25, negative: 15 },
      total_count: 100,
      warning: null
    }
  },
  onSentimentTap(event) {
    const { sentiment, name, value } = event.detail;
    console.log(`${name}: ${value}%`);
  }
});
```

---

## 5. å…³é”®è¯äº‘ç»„ä»¶

### 5.1 ç»„ä»¶è¯´æ˜

å±•ç¤ºä» AI å›ç­”ä¸­æå–çš„é«˜é¢‘å…³é”®è¯ï¼Œæ”¯æŒè¯äº‘å’Œåˆ—è¡¨ä¸¤ç§å±•ç¤ºæ¨¡å¼ã€‚

### 5.2 å±æ€§ (Properties)

| å±æ€§å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| keywordsData | Array | `[]` | å…³é”®è¯æ•°æ®åˆ—è¡¨ |
| displayMode | String | `'cloud'` | å±•ç¤ºæ¨¡å¼ï¼š`cloud`(è¯äº‘) æˆ– `list`(åˆ—è¡¨) |
| title | String | `'å…³é”®è¯äº‘'` | ç»„ä»¶æ ‡é¢˜ |
| maxKeywords | Number | `50` | æœ€å¤§æ˜¾ç¤ºå…³é”®è¯æ•°é‡ |
| minCount | Number | `1` | æœ€å°è¯é¢‘è¿‡æ»¤ |
| showSentimentColor | Boolean | `true` | æ˜¯å¦æ˜¾ç¤ºæƒ…æ„Ÿé¢œè‰² |
| showCount | Boolean | `true` | æ˜¯å¦æ˜¾ç¤ºè¯é¢‘ |

### 5.3 äº‹ä»¶ (Events)

| äº‹ä»¶å | å‚æ•° | è¯´æ˜ |
|--------|------|------|
| bind:keywordTap | `{keyword, count, sentiment, index}` | ç‚¹å‡»å…³é”®è¯æ—¶è§¦å‘ |
| bind:keywordLongPress | `{keyword, count, sentiment, index}` | é•¿æŒ‰å…³é”®è¯æ—¶è§¦å‘ |
| bind:displayModeChange | `{mode}` | åˆ‡æ¢å±•ç¤ºæ¨¡å¼æ—¶è§¦å‘ |
| bind:exportImage | `{keywords, stats}` | è¯·æ±‚å¯¼å‡ºå›¾ç‰‡æ—¶è§¦å‘ |

### 5.4 æ•°æ®æ ¼å¼

```javascript
[
  {
    word: 'è´¨é‡',
    count: 25,
    sentiment: 0.8,
    sentiment_label: 'positive'
  },
  {
    word: 'ä»·æ ¼',
    count: 18,
    sentiment: -0.3,
    sentiment_label: 'negative'
  }
]
```

### 5.5 ä½¿ç”¨ç¤ºä¾‹

```xml
<!-- WXML -->
<keyword-cloud
  keywords-data="{{keywords}}"
  display-mode="cloud"
  title="å…³é”®è¯äº‘"
  max-keywords="{{50}}"
  show-sentiment-color="{{true}}"
  bind:keywordTap="onKeywordTap"
></keyword-cloud>
```

```javascript
// JS
Page({
  data: {
    keywords: [
      { word: 'è´¨é‡', count: 25, sentiment: 0.8, sentiment_label: 'positive' },
      { word: 'ä»·æ ¼', count: 18, sentiment: -0.3, sentiment_label: 'negative' }
    ]
  },
  onKeywordTap(event) {
    const { keyword, count, sentiment } = event.detail;
    console.log(`${keyword}: ${count}æ¬¡ï¼Œæƒ…æ„Ÿï¼š${sentiment}`);
  }
});
```

---

## 6. æŠ¥å‘Šæ•°æ®æœåŠ¡

### 6.1 æœåŠ¡è¯´æ˜

`reportService.js` æä¾›æŠ¥å‘Šæ•°æ®çš„ API è°ƒç”¨ã€ç¼“å­˜ç®¡ç†å’Œæ•°æ®æ ¼å¼åŒ–åŠŸèƒ½ã€‚

### 6.2 ä¸»è¦æ–¹æ³•

| æ–¹æ³•å | å‚æ•° | è¿”å›å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| getFullReport | `executionId` | `Promise<Object>` | è·å–å®Œæ•´æŠ¥å‘Š |
| getBrandDistribution | `executionId` | `Promise<Object>` | è·å–å“ç‰Œåˆ†å¸ƒ |
| getSentimentDistribution | `executionId` | `Promise<Object>` | è·å–æƒ…æ„Ÿåˆ†å¸ƒ |
| getKeywords | `executionId, topN` | `Promise<Array>` | è·å–å…³é”®è¯ |
| getTrendAnalysis | `executionId` | `Promise<Object>` | è·å–è¶‹åŠ¿åˆ†æ |
| formatBrandDistributionForChart | `distribution` | `Array` | æ ¼å¼åŒ–ä¸ºå›¾è¡¨æ•°æ® |
| formatSentimentForChart | `distribution` | `Array` | æ ¼å¼åŒ–ä¸ºæƒ…æ„Ÿå›¾è¡¨ |
| formatKeywordsForWordCloud | `keywords` | `Array` | æ ¼å¼åŒ–ä¸ºè¯äº‘æ•°æ® |

### 6.3 ä½¿ç”¨ç¤ºä¾‹

```javascript
import reportService from '../../services/reportService';

Page({
  async onLoad(options) {
    const executionId = options.executionId;

    try {
      // è·å–å“ç‰Œåˆ†å¸ƒ
      const brandData = await reportService.getBrandDistribution(executionId);

      // è·å–æƒ…æ„Ÿåˆ†å¸ƒ
      const sentimentData = await reportService.getSentimentDistribution(executionId);

      // è·å–å…³é”®è¯
      const keywords = await reportService.getKeywords(executionId, 50);

      this.setData({
        brandData,
        sentimentData,
        keywords
      });
    } catch (error) {
      console.error('åŠ è½½æŠ¥å‘Šå¤±è´¥:', error);
    }
  }
});
```

---

## 7. ä½¿ç”¨ç¤ºä¾‹

### 7.1 å®Œæ•´é¡µé¢ç¤ºä¾‹

```xml
<!-- pages/report/report.wxml -->
<view class="report-page">
  <brand-distribution
    distribution-data="{{brandData}}"
    chart-type="pie"
    title="å“ç‰Œåˆ†å¸ƒ"
  ></brand-distribution>

  <sentiment-chart
    distribution-data="{{sentimentData}}"
    chart-type="donut"
    title="æƒ…æ„Ÿåˆ†å¸ƒ"
  ></sentiment-chart>

  <keyword-cloud
    keywords-data="{{keywords}}"
    display-mode="cloud"
    title="å…³é”®è¯äº‘"
  ></keyword-cloud>
</view>
```

```javascript
// pages/report/report.js
import reportService from '../../services/reportService';

Page({
  data: {
    brandData: null,
    sentimentData: null,
    keywords: []
  },

  async onLoad(options) {
    const executionId = options.executionId;
    await this.loadReport(executionId);
  },

  async loadReport(executionId) {
    try {
      const [brandData, sentimentData, keywords] = await Promise.all([
        reportService.getBrandDistribution(executionId),
        reportService.getSentimentDistribution(executionId),
        reportService.getKeywords(executionId, 50)
      ]);

      this.setData({ brandData, sentimentData, keywords });
    } catch (error) {
      console.error('åŠ è½½å¤±è´¥:', error);
    }
  }
});
```

```json
// pages/report/report.json
{
  "usingComponents": {
    "brand-distribution": "/miniprogram/components/brand-distribution/brand-distribution",
    "sentiment-chart": "/miniprogram/components/sentiment-chart/sentiment-chart",
    "keyword-cloud": "/miniprogram/components/keyword-cloud/keyword-cloud"
  }
}
```

---

## 8. å¸¸è§é—®é¢˜

### 8.1 æ•°æ®ä¸æ˜¾ç¤º

**é—®é¢˜**: ç»„ä»¶æ¸²æŸ“ä½†çœ‹ä¸åˆ°æ•°æ®

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥æ•°æ®æ ¼å¼æ˜¯å¦ç¬¦åˆè¦æ±‚
2. ç¡®è®¤ `distributionData.data` ä¸ä¸ºç©º
3. æ£€æŸ¥æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯æ—¥å¿—

### 8.2 é¢œè‰²ä¸ç”Ÿæ•ˆ

**é—®é¢˜**: è®¾ç½®çš„é¢œè‰²æ–¹æ¡ˆæ²¡æœ‰æ•ˆæœ

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®è®¤ `colorScheme` å±æ€§å€¼æ­£ç¡®ï¼ˆ`default`, `vibrant`, `pastel`ï¼‰
2. æ£€æŸ¥ `showSentimentColor` æ˜¯å¦è®¾ç½®ä¸º `true`

### 8.3 ç‚¹å‡»äº‹ä»¶ä¸è§¦å‘

**é—®é¢˜**: ç»‘å®šäº‹ä»¶åç‚¹å‡»æ²¡æœ‰ååº”

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®è®¤äº‹ä»¶ç»‘å®šè¯­æ³•æ­£ç¡®ï¼š`bind:brandTap="onBrandTap"`
2. æ£€æŸ¥é¡µé¢ä¸­æ˜¯å¦å®šä¹‰äº†å¯¹åº”çš„äº‹ä»¶å¤„ç†å‡½æ•°
3. ç¡®è®¤ç»„ä»¶æ˜¯å¦æ­£ç¡®æ³¨å†Œ

### 8.4 è¯äº‘å¸ƒå±€é‡å 

**é—®é¢˜**: è¯äº‘ä¸­çš„å…³é”®è¯é‡å æ˜¾ç¤º

**è§£å†³æ–¹æ¡ˆ**:
1. å‡å°‘ `maxKeywords` æ•°é‡
2. å¢åŠ  `minCount` è¿‡æ»¤ä½é¢‘è¯
3. è°ƒæ•´ç»„ä»¶å®¹å™¨å¤§å°

### 8.5 æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **æ•°æ®ç¼“å­˜**: ä½¿ç”¨ `reportService` çš„ç¼“å­˜åŠŸèƒ½
2. **æŒ‰éœ€åŠ è½½**: åªåŠ è½½å½“å‰é¡µé¢éœ€è¦çš„æ•°æ®
3. **é™åˆ¶æ•°é‡**: è®¾ç½®åˆç†çš„ `maxKeywords` å€¼
4. **æ‡’åŠ è½½**: ä½¿ç”¨ `wx.createSelectorQuery` å»¶è¿Ÿæ¸²æŸ“

---

## é™„å½•

### A. ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´å†…å®¹ |
|------|------|---------|
| 1.0.0 | 2026-02-27 | åˆå§‹ç‰ˆæœ¬ |

### B. ç›¸å…³æ–‡ä»¶

- `2026-02-27-é‡æ„å¼€å‘è§„èŒƒ.md` - å‰ç«¯å¼€å‘è§„èŒƒ
- `2026-02-27-é‡æ„å®æ–½è·¯çº¿å›¾ -2.md` - é˜¶æ®µäºŒéœ€æ±‚æ–‡æ¡£

### C. è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·è”ç³»ç³»ç»Ÿæ¶æ„ç»„ã€‚

---

**æ–‡æ¡£ç»“æŸ**
