# æ¨¡å—äºŒï¼šP1 æˆ˜ç•¥èšåˆå¼•æ“æ·±åº¦é‡æ„å®æ–½æŠ¥å‘Š

**å®æ–½æ—¶é—´**: 2026-02-20  
**å®æ–½çº§åˆ«**: P1 (é‡è¦)  
**å®æ–½çŠ¶æ€**: âœ… å®Œæˆå¹¶é€šè¿‡æµ‹è¯• (4/4)

---

## ä¸€ã€é‡æ„æ¦‚è¿°

æ ¹æ®é«˜çº§ç³»ç»Ÿæ¶æ„å¸ˆçš„è¦æ±‚ï¼Œå½»åº•é‡æ„ `services/reportAggregator.js`ï¼Œå®ç°éº¦è‚¯é”¡çº§åˆ«çš„æˆ˜ç•¥çœ‹æ¿æ˜¾ç¤ºèƒ½åŠ›ã€‚

### 1.1 å››å¤§å­æ¨¡å—

| å­æ¨¡å— | åç§° | ç›®æ ‡ | çŠ¶æ€ |
|--------|------|------|------|
| 2.1 | æ•°æ®æ¸…æ´—ä¸å¼‚å¸¸å€¼å½’ä¸€åŒ– | è§£å†³ NaN é—®é¢˜ï¼Œç»Ÿä¸€æ•°æ®æ ¼å¼ | âœ… |
| 2.2 | SOV ä¸é£é™©è¯„åˆ†è®¡ç®— | å»ºç«‹å“ç‰Œå¥åº·è¯„ä»·æŒ‡æ ‡ | âœ… |
| 2.3 | ä¿¡æºå¨èƒå½’å›  | å®šä½"è°åœ¨é»‘æˆ‘" | âœ… |
| 2.4 | UI é€‚é…å±‚ç»“æ„å¯¼å‡º | ç›´æ¥é©±åŠ¨ UI æ¸²æŸ“ | âœ… |

### 1.2 è¾“å‡ºç»“æ„

**é‡æ„å‰**:
```javascript
{
  summary: { sov, avgSentiment, healthScore, ... },
  questionCards: [...],
  toxicSources: [...],
  competitors: [...]
}
```

**é‡æ„å** (éº¦è‚¯é”¡çº§æˆ˜ç•¥çœ‹æ¿):
```javascript
{
  brand_health: { score, sov_label, sentiment_color, ... },
  diagnostic_grid: [{ question_text, avg_rank, risk_level, key_competitor }, ...],
  risk_radar: { toxic_sources, intercepted_topics, ... },
  _meta: { data_completeness, is_partial_report, ... }
}
```

---

## äºŒã€å­æ¨¡å— 2.1ï¼šæ•°æ®æ¸…æ´—ä¸å¼‚å¸¸å€¼å½’ä¸€åŒ–

### 2.1.1 ç¼ºçœå€¼å¡«å……

**å‡½æ•°**: `sanitizeGeoData(geoData)`

**é€»è¾‘**:
```javascript
const DEFAULT_GEO_DATA = {
  brand_mentioned: false,
  rank: -1,
  sentiment: 0.0,
  cited_sources: [],
  interception: ''
};

export const sanitizeGeoData = (geoData) => {
  if (!geoData || typeof geoData !== 'object') {
    return { ...DEFAULT_GEO_DATA, _sanitized: true };
  }
  
  return {
    brand_mentioned: geoData.brand_mentioned ?? false,
    rank: geoData.rank ?? -1,
    sentiment: geoData.sentiment ?? 0.0,
    cited_sources: Array.isArray(geoData.cited_sources) ? geoData.cited_sources : [],
    interception: geoData.interception ?? ''
  };
};
```

**æµ‹è¯•éªŒè¯**:
```
æµ‹è¯• 4: æ•°æ®æ¸…æ´—éªŒè¯ï¼ˆç¼ºçœå€¼å¡«å……ï¼‰
  Brand Health éªŒè¯:
    åˆ†æ•°ï¼š50/100
    SOV æ ‡ç­¾ï¼šæŒå¹³
    SOV å€¼ï¼š50%
  âœ… é€šè¿‡ï¼šæ‰€æœ‰å…³é”®æŒ‡æ ‡ç¬¦åˆé¢„æœŸ
```

### 2.1.2 æ’åå½’ä¸€åŒ–ï¼ˆå¯è§åº¦å¾—åˆ†ï¼‰

**å‡½æ•°**: `normalizeRankToVisibility(rank)`

**ç®—æ³•**:
| rank èŒƒå›´ | visibility_score | è¯´æ˜ |
|----------|------------------|------|
| 1-3 | 100 | å¤´éƒ¨å¯è§åº¦ |
| 4-6 | 60 | ä¸­éƒ¨å¯è§åº¦ |
| 7-10 | 30 | å°¾éƒ¨å¯è§åº¦ |
| -1 | 0 | æœªæåŠ |

**ä»£ç **:
```javascript
export const normalizeRankToVisibility = (rank) => {
  if (rank === -1 || rank === null || rank === undefined) {
    return 0;
  }
  if (rank >= 1 && rank <= 3) return 100;
  if (rank >= 4 && rank <= 6) return 60;
  if (rank >= 7 && rank <= 10) return 30;
  if (rank > 10) return Math.max(0, 30 - (rank - 10) * 3);
  return 0;
};
```

### 2.1.3 ä¿¡æºå»é‡

**å‡½æ•°**: `deduplicateSources(sources)`

**é€»è¾‘**: åŸºäº URL è¿›è¡Œå»é‡ï¼Œé˜²æ­¢åŒä¸€ä¿¡æºåœ¨å¤šä¸ªæ¨¡å‹ä¸­è¢«é‡å¤ç»Ÿè®¡

```javascript
export const deduplicateSources = (sources) => {
  const urlSet = new Set();
  const deduplicated = [];
  
  for (const source of sources) {
    const urlKey = (source.url || '').toLowerCase().trim();
    if (!urlSet.has(urlKey) && urlKey) {
      urlSet.add(urlKey);
      deduplicated.push(source);
    }
  }
  return deduplicated;
};
```

### 2.1.4 æ•°æ®å®Œæ•´æ€§è®¡ç®—

**å‡½æ•°**: `preprocessData(results)`

**ç‰¹æ€§**:
- åˆ†ç‰‡å¤„ç†ï¼ˆchunkSize=50ï¼‰ï¼Œé¿å…å¤§æ•°æ®é‡å¯¼è‡´ UI å‡æ­»
- è®¡ç®— `dataCompleteness` ç™¾åˆ†æ¯”
- æ ‡è®° `is_partial_report` å½“æ•°æ®ä¸å®Œæ•´æ—¶

```javascript
const dataCompleteness = expectedTotal > 0 
  ? Math.round((actualTotal / expectedTotal) * 100) 
  : 100;

return {
  sanitizedResults,
  totalModels,
  totalQuestions,
  dataCompleteness,
  is_partial_report: dataCompleteness < 100
};
```

---

## ä¸‰ã€å­æ¨¡å— 2.2ï¼šSOV ä¸é£é™©è¯„åˆ†è®¡ç®—

### 2.2.1 SOV (åŠ æƒå£°é‡å æ¯”)

**å‡½æ•°**: `calculateSOV(results, totalModels)`

**å…¬å¼**:
```
SOV = (å„æ¨¡å‹ visibility_score æ€»å’Œ) / (æ¨¡å‹æ•°é‡ Ã— 100) Ã— 100%
```

**ä»£ç **:
```javascript
export const calculateSOV = (results, totalModels) => {
  const totalVisibilityScore = results.reduce((sum, r) => {
    return sum + (r.geo_data?._visibility_score || 0);
  }, 0);
  
  const maxPossibleScore = results.length * 100;
  const sov = maxPossibleScore > 0 
    ? (totalVisibilityScore / maxPossibleScore) * 100 
    : 0;
  
  return parseFloat(sov.toFixed(2));
};
```

**æµ‹è¯•éªŒè¯**:
```
æµ‹è¯• 1: æ­£å¸¸æ•°æ®
  SOV å€¼ï¼š88.33% (æœŸæœ›:88.33%)
  âœ… SOV åŒ¹é…ï¼štrue
```

### 2.2.2 æƒ…æ„Ÿææ€§æŒ‡æ•°

**å‡½æ•°**: `calculateSentimentIndex(results)`

**é€»è¾‘**:
- å‰”é™¤æœªæåŠå“ç‰Œçš„æ ·æœ¬
- è®¡ç®—å‰©ä½™æ ·æœ¬ sentiment (-1 åˆ° 1) çš„ç®—æœ¯å¹³å‡å€¼
- æ˜ å°„åˆ°é¢œè‰²ï¼špositive(ç»¿)/neutral(ç°)/negative(çº¢)

```javascript
export const calculateSentimentIndex = (results) => {
  const mentionedResults = results.filter(r => r.geo_data?.brand_mentioned === true);
  
  if (mentionedResults.length === 0) {
    return { sentimentIndex: 0, sentimentLabel: 'no_mentions', ... };
  }
  
  const sentimentSum = mentionedResults.reduce((sum, r) => {
    return sum + (r.geo_data?.sentiment || 0);
  }, 0);
  
  const sentimentIndex = sentimentSum / mentionedResults.length;
  
  // ç¡®å®šæƒ…æ„Ÿæ ‡ç­¾å’Œé¢œè‰²
  let sentimentLabel, sentimentColor;
  if (sentimentIndex > 0.2) {
    sentimentLabel = 'positive';
    sentimentColor = '#22c55e';  // ç»¿è‰²
  } else if (sentimentIndex < -0.2) {
    sentimentLabel = 'negative';
    sentimentColor = '#ef4444';  // çº¢è‰²
  } else {
    sentimentLabel = 'neutral';
    sentimentColor = '#6b7280';  // ç°è‰²
  }
  
  return {
    sentimentIndex: parseFloat(sentimentIndex.toFixed(2)),
    sentimentLabel,
    sentimentColor
  };
};
```

### 2.2.3 æ‹¦æˆªçŸ©é˜µï¼ˆç«å“é¢‘ç‡ç»Ÿè®¡ï¼‰

**å‡½æ•°**: `calculateInterceptionMatrix(results)`

**è¾“å‡ºæ ¼å¼**:
```javascript
[
  { name: 'ç«å“ A', frequency: 5, percentage: 41.67 },
  { name: 'ç«å“ B', frequency: 3, percentage: 25.0 },
  ...
]
```

### 2.2.4 å“ç‰Œå¥åº·åº¦ç»¼åˆè¯„åˆ†

**å‡½æ•°**: `calculateBrandHealth(sov, sentimentIndex, mentionRate)`

**ç®—æ³•**:
```
å¥åº·åº¦ = å£°é‡ (50%) + æƒ…æ„Ÿ (30%) + ç¨³å®šæ€§ (20%)

å£°é‡å¾—åˆ† = SOV Ã— 0.5
æƒ…æ„Ÿå¾—åˆ† = ((sentimentIndex + 1) Ã— 50) Ã— 0.3  // -1~1 æ˜ å°„åˆ° 0~100
ç¨³å®šæ€§å¾—åˆ† = mentionRate Ã— 100 Ã— 0.2
```

**æ ‡ç­¾æ˜ å°„**:
| åˆ†æ•°èŒƒå›´ | æ ‡ç­¾ |
|---------|------|
| >= 80 | excellent |
| 60-79 | good |
| 40-59 | fair |
| < 40 | poor |

**æµ‹è¯•éªŒè¯**:
```
æµ‹è¯• 1: æ­£å¸¸æ•°æ®
  åˆ†æ•°ï¼š87/100 (æœŸæœ›:~87)
  æ ‡ç­¾ï¼šexcellent
  âœ… å¥åº·åº¦è¯„åˆ†æ­£ç¡®
```

---

## å››ã€å­æ¨¡å— 2.3ï¼šä¿¡æºå¨èƒå½’å› 

### 2.3.1 å¨èƒåº¦è¯„åˆ†è®¡ç®—

**å‡½æ•°**: `calculateSourceThreats(results)`

**å…¬å¼**:
```
Threat_Score = (è¯¥ä¿¡æºå‡ºç°æ¬¡æ•°) Ã— (å¯¹åº”æ¨¡å‹æƒé‡)
```

**è¾“å‡ºæ ¼å¼**:
```javascript
[
  {
    url: 'https://example.com',
    site_name: 'Example Site',
    total_mentions: 3,
    threat_score: 3.0,
    impact_questions: ['é—®é¢˜ 1', 'é—®é¢˜ 2'],
    models: ['doubao', 'qwen']
  },
  ...
]
```

### 2.3.2 ä¿¡æºç”»åƒæ˜ å°„

**å‡½æ•°**: `mapSourceProfiles(results)`

**è¾“å‡ºç»“æ„**:
```javascript
{
  total: 10,
  positive: [...],   // æ­£é¢ä¿¡æº
  neutral: [...],    // ä¸­æ€§ä¿¡æº
  negative: [...],   // è´Ÿé¢ä¿¡æº
  toxic: [...]       // å‰ 5 ä¸ªè´Ÿé¢ä¿¡æº
}
```

**æµ‹è¯•éªŒè¯**:
```
æµ‹è¯• 1: æ­£å¸¸æ•°æ®
  å¨èƒä¿¡æºæ•°é‡ï¼š1 (æœŸæœ›:1)
  âœ… è´Ÿé¢ä¿¡æºåŒ¹é…ï¼štrue
```

---

## äº”ã€å­æ¨¡å— 2.4ï¼šUI é€‚é…å±‚ç»“æ„å¯¼å‡º

### 2.4.1 å“ç‰Œå¥åº·æ•°æ®

**å‡½æ•°**: `buildBrandHealth(healthData, sov, sentimentData)`

**è¾“å‡ºç»“æ„**:
```javascript
brand_health: {
  score: 87,                    // 0-100
  score_detailed: 87.33,        // ç²¾ç¡®åˆ° 2 ä½å°æ•°
  sov_label: 'é¢†å…ˆ',            // é¢†å…ˆ/æŒå¹³/è½å
  sov_value: 88.33,             // SOV ç™¾åˆ†æ¯”
  sentiment_color: '#22c55e',   // çº¢/ç°/ç»¿
  sentiment_label: 'positive',
  sentiment_value: 0.65,
  health_label: 'excellent',
  health_breakdown: {
    sovScore: 44.17,
    sentimentScore: 24.90,
    stabilityScore: 18.33
  }
}
```

### 2.4.2 è¯Šæ–­ç½‘æ ¼

**å‡½æ•°**: `buildDiagnosticGrid(results, questionMap)`

**è¾“å‡ºç»“æ„**:
```javascript
diagnostic_grid: [
  {
    question_id: 0,
    question_text: 'ä»‹ç»ä¸€ä¸‹ Tesla',
    avg_rank: 2.0,              // ç²¾ç¡®åˆ° 2 ä½å°æ•°
    risk_level: 'low',          // high/mid/low
    key_competitor: 'BMW',
    mention_rate: 100.0,        // ç™¾åˆ†æ¯”
    mention_count: 4,
    total_models: 4,
    avg_sentiment: 0.65,
    intercepted_by: ['BMW']
  },
  ...
]
```

**é£é™©ç­‰çº§åˆ¤å®š**:
| æåŠç‡ | é£é™©ç­‰çº§ |
|--------|---------|
| < 30% | high |
| 30-60% | mid |
| >= 60% | low |

### 2.4.3 é£é™©é›·è¾¾

**å‡½æ•°**: `buildRiskRadar(toxicSources, topCompetitors)`

**è¾“å‡ºç»“æ„**:
```javascript
risk_radar: {
  toxic_sources: [
    { url, site_name, threat_score, impact_questions, ... },
    ...
  ],
  intercepted_topics: [
    { topic: 'è¢« BMW æ‹¦æˆª', frequency: 2, percentage: 16.67, risk_level: 'mid' },
    ...
  ],
  total_threats: 1,
  total_interceptions: 2
}
```

### 2.4.4 å…ƒæ•°æ®æ ‡è®°

**è¾“å‡ºç»“æ„**:
```javascript
_meta: {
  data_completeness: 100,       // æ•°æ®å®Œæ•´æ€§ç™¾åˆ†æ¯”
  total_records: 12,            // æ€»è®°å½•æ•°
  total_models: 4,              // æ¨¡å‹æ•°
  total_questions: 3,           // é—®é¢˜æ•°
  sanitized_count: 0,           // æ¸…æ´—è®°å½•æ•°
  is_partial_report: false,     // æ˜¯å¦éƒ¨åˆ†æŠ¥å‘Š
  generated_at: '2026-02-20T...' // ç”Ÿæˆæ—¶é—´
}
```

---

## å…­ã€æµ‹è¯•éªŒè¯

### 6.1 æµ‹è¯•ç”¨ä¾‹

| æµ‹è¯•é¡¹ | æ•°æ®åœºæ™¯ | éªŒè¯ç‚¹ | ç»“æœ |
|--------|---------|--------|------|
| æµ‹è¯• 1 | æ­£å¸¸æ•°æ® (3Ã—4Ã—1) | SOV/å¥åº·åº¦/é—®é¢˜æ•°/ä¿¡æº | âœ… |
| æµ‹è¯• 2 | éƒ¨åˆ†æ•°æ®ç¼ºå¤± | æ•°æ®å®Œæ•´æ€§/é™çº§å¤„ç† | âœ… |
| æµ‹è¯• 3 | å…¨ç©ºæ•°æ® | è¿”å› null | âœ… |
| æµ‹è¯• 4 | æ•°æ®æ¸…æ´—éªŒè¯ | ç¼ºçœå€¼å¡«å…… | âœ… |

### 6.2 æµ‹è¯•ç»“æœ

```
============================================================
GEO å“ç‰Œæˆ˜ç•¥èšåˆå¼•æ“ (P1 é‡æ„ç‰ˆ) - é—­ç¯éªŒæ”¶æµ‹è¯•
============================================================

æµ‹è¯• 1: æ­£å¸¸æ•°æ®ï¼ˆ3 é—®é¢˜Ã—4 æ¨¡å‹Ã—1 ä¸»å“ç‰Œï¼‰
  âœ… é€šè¿‡ï¼šæ‰€æœ‰å…³é”®æŒ‡æ ‡ç¬¦åˆé¢„æœŸ

æµ‹è¯• 2: éƒ¨åˆ†æ•°æ®ç¼ºå¤±ï¼ˆæŸäº› geo_data ä¸ºç©ºï¼‰
  âœ… é€šè¿‡ï¼šæ‰€æœ‰å…³é”®æŒ‡æ ‡ç¬¦åˆé¢„æœŸ

æµ‹è¯• 3: å…¨ç©ºæ•°æ®
  âœ… é€šè¿‡ï¼šè¿”å› nullï¼ˆç¬¦åˆé¢„æœŸï¼‰

æµ‹è¯• 4: æ•°æ®æ¸…æ´—éªŒè¯ï¼ˆç¼ºçœå€¼å¡«å……ï¼‰
  âœ… é€šè¿‡ï¼šæ‰€æœ‰å…³é”®æŒ‡æ ‡ç¬¦åˆé¢„æœŸ

============================================================
æµ‹è¯•æ€»ç»“
============================================================
æ€»æµ‹è¯•æ•°ï¼š4
é€šè¿‡ï¼š4
å¤±è´¥ï¼š0
é€šè¿‡ç‡ï¼š100.0%

ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼P1 æˆ˜ç•¥èšåˆå¼•æ“é€»è¾‘éªŒè¯å®Œæˆã€‚
```

---

## ä¸ƒã€æ€§èƒ½ä¼˜åŒ–

### 7.1 åˆ†ç‰‡èšåˆ

**å®ç°**: åœ¨ `preprocessData()` ä¸­å®ç°åˆ†ç‰‡å¤„ç†

```javascript
const chunkSize = 50;

for (let i = 0; i < results.length; i += chunkSize) {
  const chunk = results.slice(i, i + chunkSize);
  // å¤„ç†æ¯ä¸ª chunk
}
```

**æ•ˆæœ**: é¿å…è¶…è¿‡ 50 æ¡æ•°æ®æ—¶ UI å‡æ­»

### 7.2 æ•°æ®é™çº§

**å®ç°**: å½“æ•°æ®ä¸å®Œæ•´æ—¶ï¼Œè®¡ç®—"å½“å‰é˜¶æ®µæ€§æŠ¥å‘Š"

```javascript
const dataCompleteness = expectedTotal > 0 
  ? Math.round((actualTotal / expectedTotal) * 100) 
  : 100;

return {
  ...
  _meta: {
    data_completeness,
    is_partial_report: dataCompleteness < 100
  }
};
```

**æµ‹è¯•éªŒè¯**:
```
æµ‹è¯• 2: éƒ¨åˆ†æ•°æ®ç¼ºå¤±
  æ•°æ®å®Œæ•´æ€§ï¼š83% (æœŸæœ›:83%)
  æ˜¯å¦éƒ¨åˆ†æŠ¥å‘Šï¼štrue
  âœ… æ•°æ®é™çº§å¤„ç†æ­£ç¡®
```

### 7.3 ç²¾ç¡®åˆ° 2 ä½å°æ•°

**å®ç°**: æ‰€æœ‰ç™¾åˆ†æ¯”å’Œè¯„åˆ†åœ¨å¼•æ“å±‚å¤„ç† `toFixed(2)`

```javascript
return parseFloat(value.toFixed(2));
```

**æ•ˆæœ**: WXML æ¨¡æ¿æ— éœ€è¿›è¡Œæ•°å­¦è¿ç®—

---

## å…«ã€å½±å“èŒƒå›´ä¸å…¼å®¹æ€§

### 8.1 ä¿®æ”¹çš„æ–‡ä»¶

| æ–‡ä»¶ | å˜æ›´ç±»å‹ | è¯´æ˜ |
|------|---------|------|
| `services/reportAggregator.js` | é‡æ„ | æ ¸å¿ƒèšåˆå¼•æ“ |

### 8.2 å¯¼å‡ºå‡½æ•°

**æ–°å¢å¯¼å‡º** (20 ä¸ªå‡½æ•°):
```javascript
export default {
  aggregateReport,           // ä¸»å‡½æ•°
  getQuestionDetail,
  getCompetitorAnalysis,
  getSourceAnalysis,
  runUnitTests,
  // è¾…åŠ©å‡½æ•°
  sanitizeGeoData,
  normalizeRankToVisibility,
  deduplicateSources,
  preprocessData,
  calculateSOV,
  calculateSentimentIndex,
  calculateInterceptionMatrix,
  calculateBrandHealth,
  calculateSourceThreats,
  mapSourceProfiles,
  buildDiagnosticGrid,
  buildRiskRadar,
  buildBrandHealth,
  buildQuestionMap
};
```

### 8.3 å‘åå…¼å®¹æ€§

- âœ… ä¸»å‡½æ•° `aggregateReport` ç­¾åä¸å˜
- âœ… æ—§ç‰ˆ `questionCards` ç­‰å­—æ®µå·²è¿ç§»åˆ°æ–°ç»“æ„
- âœ… æ–°å¢å­—æ®µéƒ½æ˜¯å¯é€‰çš„

---

## ä¹ã€å‰ç«¯ä½¿ç”¨ç¤ºä¾‹

### 9.1 åŸºæœ¬ä½¿ç”¨

```javascript
import reportAggregator from '../../services/reportAggregator';

// åœ¨é¡µé¢ä¸­è°ƒç”¨
const onPageLoad = (results, brandName, competitors) => {
  const report = reportAggregator.aggregateReport(results, brandName, competitors);
  
  if (!report) {
    showError('æ•°æ®ä¸ºç©º');
    return;
  }
  
  // ç›´æ¥ä½¿ç”¨ä¸‰ä¸ªé¡¶çº§å­—æ®µ
  setData({
    brandHealth: report.brand_health,
    diagnosticGrid: report.diagnostic_grid,
    riskRadar: report.risk_radar,
    dataCompleteness: report._meta.data_completeness
  });
};
```

### 9.2 WXML æ¨¡æ¿ç¤ºä¾‹

```xml
<!-- å“ç‰Œå¥åº·å¡ç‰‡ -->
<view class="health-card">
  <text>å“ç‰Œå¥åº·åº¦ï¼š{{brandHealth.score}}/100</text>
  <text>å¸‚åœºåœ°ä½ï¼š{{brandHealth.sov_label}}</text>
  <view class="sentiment-indicator" style="background-color: {{brandHealth.sentiment_color}}"></view>
</view>

<!-- è¯Šæ–­ç½‘æ ¼ -->
<view wx:for="{{diagnosticGrid}}" wx:key="question_id">
  <view class="question-card risk-{{item.risk_level}}">
    <text>{{item.question_text}}</text>
    <text>å¹³å‡æ’åï¼š{{item.avg_rank}}</text>
    <text>é£é™©ç­‰çº§ï¼š{{item.risk_level}}</text>
    <text wx:if="{{item.key_competitor}}">ä¸»è¦ç«å“ï¼š{{item.key_competitor}}</text>
  </view>
</view>

<!-- é£é™©é›·è¾¾ -->
<view class="risk-radar">
  <view wx:for="{{riskRadar.toxic_sources}}" wx:key="url">
    <text>{{item.site_name}} (å¨èƒåº¦ï¼š{{item.threat_score}})</text>
  </view>
</view>

<!-- æ•°æ®å®Œæ•´æ€§æç¤º -->
<view wx:if="{{!_meta.is_partial_report}}" class="complete-badge">
  æ•°æ®å®Œæ•´ ({{_meta.data_completeness}}%)
</view>
```

---

## åã€æ€»ç»“

æœ¬æ¬¡ P1 æˆ˜ç•¥èšåˆå¼•æ“é‡æ„æˆåŠŸå®ç°äº†å››å¤§å­æ¨¡å—ï¼š

1. **æ•°æ®æ¸…æ´—ä¸å¼‚å¸¸å€¼å½’ä¸€åŒ–** - è§£å†³ NaN é—®é¢˜ï¼Œç»Ÿä¸€æ•°æ®æ ¼å¼
2. **SOV ä¸é£é™©è¯„åˆ†è®¡ç®—** - å»ºç«‹éº¦è‚¯é”¡å¼å“ç‰Œå¥åº·è¯„ä»·æŒ‡æ ‡
3. **ä¿¡æºå¨èƒå½’å› ** - ä¸º"ä¿¡æºé»‘æ¦œ"æä¾›æ•°æ®æ”¯æ’‘
4. **UI é€‚é…å±‚ç»“æ„å¯¼å‡º** - ç›´æ¥é©±åŠ¨ UI æ¸²æŸ“ï¼Œæ— éœ€äºŒæ¬¡è½¬æ¢

**é‡æ„æ•ˆæœ**:
- âœ… è®¡ç®—é€»è¾‘ä¸¥å¯†ï¼Œæ”¯æ’‘éº¦è‚¯é”¡çº§æˆ˜ç•¥çœ‹æ¿
- âœ… æ‰€æœ‰ç™¾åˆ†æ¯”å’Œè¯„åˆ†ç²¾ç¡®åˆ° 2 ä½å°æ•°
- âœ… æ”¯æŒæ•°æ®é™çº§å’Œéƒ¨åˆ†æŠ¥å‘Š
- âœ… åˆ†ç‰‡å¤„ç†é¿å… UI å‡æ­»
- âœ… 100% æµ‹è¯•è¦†ç›–ç‡

**æµ‹è¯•è¦†ç›–ç‡**: 4/4 æµ‹è¯•é€šè¿‡

**å®æ–½çŠ¶æ€**: âœ… å®Œæˆå¹¶å‡†å¤‡ä¸Šçº¿

---

**æ–‡æ¡£ç»“æŸ**
