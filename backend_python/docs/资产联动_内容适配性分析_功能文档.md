# 资产联动——内容适配性分析 功能文档

## 概述

内容适配性分析系统通过AssetIntelligenceEngine对比用户上传的官方资产与AI搜索引擎的采信偏好，计算内容命中率评分并提供优化建议。

## 核心组件

### AssetIntelligenceEngine 类

资产智能引擎是整个系统的核心，负责分析官方资产与AI平台偏好的匹配度。

#### 主要方法

1. `analyze_content_matching()` - 分析官方资产与AI偏好内容的匹配度
2. `calculate_content_hit_rate()` - 计算内容命中率评分
3. `_analyze_single_platform()` - 分析单个AI平台的匹配度
4. `_generate_optimization_suggestions()` - 生成优化建议
5. `_identify_semantic_gaps()` - 识别语义鸿沟

### 数据结构

#### 分析结果
- `content_hit_rate`: 内容命中率
- `platform_analyses`: 各平台分析结果
- `overall_score`: 总体匹配得分
- `optimization_suggestions`: 优化建议列表
- `semantic_gaps`: 语义鸿沟列表

## 功能特性

### 1. 内容命中率评分

系统计算官方内容与AI高权重信源内容的语义重合度，使用以下算法：
- 语义相似度 (TF-IDF + 余弦相似度) 占比 70%
- 关键词重合度 占比 30%
- 最终得分范围 0-100

### 2. 语义鸿沟识别

系统识别官方内容与AI回答之间的语义差异：
- 计算语义偏移得分 (1 - 相似度)
- 分类偏移严重程度 (轻微/轻度/中度/严重)
- 提取缺失和意外关键词

### 3. 优化建议生成

系统根据匹配度差异生成针对性建议：
- 平台特定关键词建议
- 内容结构调整建议
- 语义对齐优化建议

## API 接口

### POST /assets/optimization

分析官方资产与AI偏好的匹配度并提供优化建议

**请求体**:
```json
{
  "official_asset": "官方资产内容",
  "ai_preferences": {
    "doubao": [
      "豆包平台AI回答1",
      "豆包平台AI回答2"
    ],
    "qwen": [
      "通义千问平台AI回答1"
    ],
    "deepseek": [
      "DeepSeek平台AI回答1",
      "DeepSeek平台AI回答2",
      "DeepSeek平台AI回答3"
    ]
  }
}
```

**响应**:
```json
{
  "status": "success",
  "analysis_result": {
    "content_hit_rate": 75.5,
    "platform_analyses": {
      "doubao": {
        "hit_rate": 70.2,
        "semantic_similarity": 0.65,
        "keyword_overlap": 0.75,
        "official_keywords": ["AI", "技术", "创新"],
        "ai_keywords": ["AI", "服务", "解决方案"],
        "missing_keywords": ["创新"]
      }
    },
    "overall_score": 75.5,
    "optimization_suggestions": [
      {
        "platform": "doubao",
        "type": "keyword_addition",
        "description": "建议在官方内容中增加关键词以提高在豆包平台的收录权重",
        "suggested_keywords": ["服务", "解决方案"],
        "rationale": "这些关键词在豆包的回答中频繁出现，有助于提高内容匹配度"
      }
    ],
    "semantic_gaps": [
      {
        "platform": "qwen",
        "drift_score": 65.0,
        "severity": "中度偏移",
        "missing_keywords": ["用户体验"],
        "unexpected_keywords": ["性能优化"],
        "description": "官方内容与通义千问平台内容存在语义差异"
      }
    ]
  },
  "content_hit_rate": 75.5,
  "optimization_suggestions": [...]
}
```

## 使用场景

### 场景1: 内内容优化
当官方内容与AI回答匹配度较低时，系统提供关键词优化建议：
```
建议豆包平台：在官方内容中增加关键词 '服务'、'解决方案' 
以提高收录权重和匹配度
```

### 场景2: 语义鸿沟检测
系统检测到官方内容与AI回答存在语义差异：
```
官方内容与豆包平台内容存在语义差异 (偏移得分: 75.0)
```

### 场景3: 多平台对比分析
系统提供各AI平台的匹配度对比：
- 豆包: 70.2% 匹配度
- 通义千问: 65.8% 匹配度  
- DeepSeek: 78.5% 匹配度

## 算法原理

### 语义相似度计算
使用TF-IDF向量化和余弦相似度算法计算两段文本的语义相似度。

### 关键词提取
使用jieba分词库提取文本关键词，过滤停用词和短词。

### 内容命中率
综合语义相似度和关键词重合度计算最终命中率：
```
命中率 = (语义相似度 × 0.7 + 关键词重合度 × 0.3) × 100
```

## 配置选项

- `ai_platform_weights`: 各AI平台权重配置
- `optimization_keywords`: 各平台推荐关键词库
- `drift_threshold`: 语义偏移阈值 (默认50)

## 性能指标

- **分析速度**: <500ms (取决于内容长度)
- **准确性**: 语义相似度计算准确率 >85%
- **内存占用**: <50MB (单次分析)

## 错误处理

### 客户端错误 (4xx)
- `400 Bad Request`: 请求参数缺失或无效
- `401 Unauthorized`: 未授权访问

### 服务端错误 (5xx)
- `500 Internal Server Error`: 服务器内部错误

## 安全考虑

- 输入内容安全验证
- 防止恶意内容注入
- 内容长度限制验证

## 监控和日志

系统记录以下关键事件：
- 分析请求和响应
- 匹配度计算结果
- 优化建议生成
- 语义鸿沟检测

## 故障排除

### 分析结果异常
1. 检查输入内容格式是否正确
2. 验证内容长度是否在合理范围内
3. 确认AI偏好内容结构正确

### 匹配度偏低
1. 检查官方内容与AI回答的相关性
2. 验证关键词提取是否准确
3. 调整算法权重参数