# ğŸ“Š è¯Šæ–­æŠ¥å‘Šæ•°æ®å¯è§†åŒ–æŸ¥çœ‹å™¨ - ä½¿ç”¨æ–‡æ¡£

## æ¦‚è¿°

å·²ä¸ºæ‚¨åˆ›å»ºäº† 3 ä¸ªè¯Šæ–­æŠ¥å‘Šæ•°æ®æŸ¥çœ‹å·¥å…·ï¼Œç”¨äºæ£€æŸ¥åå°ä¿å­˜çš„è¯Šæ–­æŠ¥å‘Šæ•°æ®å®Œæ•´æ€§ã€‚

## å·¥å…·æ¸…å•

### 1. å‘½ä»¤è¡ŒæŸ¥çœ‹å™¨ (`view_diagnosis_reports.py`)

**åŠŸèƒ½**ï¼šåœ¨ç»ˆç«¯ä¸­ä»¥è¡¨æ ¼å½¢å¼æŸ¥çœ‹è¯Šæ–­æŠ¥å‘Š

**ä½¿ç”¨æ–¹æ³•**ï¼š

```bash
# æŸ¥çœ‹æ‰€æœ‰æŠ¥å‘Šï¼ˆé»˜è®¤æœ€æ–° 20 æ¡ï¼‰
cd backend_python
python3 view_diagnosis_reports.py

# æŸ¥çœ‹æœ€æ–° N æ¡æŠ¥å‘Š
python3 view_diagnosis_reports.py --latest 10

# æŸ¥çœ‹æŒ‡å®šæŠ¥å‘Šè¯¦æƒ…
python3 view_diagnosis_reports.py --detail <execution_id>

# æŸ¥çœ‹è¯¦æƒ…å¹¶è¿›è¡Œæ•°æ®å®Œæ•´æ€§æ£€æŸ¥
python3 view_diagnosis_reports.py --detail <execution_id> --check

# å¯¼å‡ºæŠ¥å‘Šä¸º JSON æ–‡ä»¶
python3 view_diagnosis_reports.py --export <execution_id>
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
ğŸ“Š è¯Šæ–­æŠ¥å‘Šåˆ—è¡¨ (å…± 6 æ¡)

================================================================================================================================================================
ID    Execution ID                           å“ç‰Œ              ç«å“æ•°    çŠ¶æ€           è¿›åº¦     é˜¶æ®µ              å®Œæˆ     åˆ›å»ºæ—¶é—´                  
================================================================================================================================================================
15    1758f33c-cbed-41ed-b7d0-094b286ee191   è¶£è½¦è‰¯å“            1      failed       100    failed          âœ…      2026-02-28T16:05:53.243326
...
```

---

### 2. HTML å¯è§†åŒ–æŸ¥çœ‹å™¨ (`view_diagnosis_reports_html.py`)

**åŠŸèƒ½**ï¼šç”Ÿæˆç¾è§‚çš„ HTML æŠ¥å‘Šï¼Œæ”¯æŒæµè§ˆå™¨æŸ¥çœ‹

**ä½¿ç”¨æ–¹æ³•**ï¼š

```bash
cd backend_python

# ç”Ÿæˆ HTML æŠ¥å‘Šï¼ˆé»˜è®¤æœ€æ–° 20 æ¡ï¼‰
python3 view_diagnosis_reports_html.py

# ç”Ÿæˆæœ€æ–° N æ¡æŠ¥å‘Šçš„ HTML
python3 view_diagnosis_reports_html.py --latest 10

# è‡ªå®šä¹‰è¾“å‡ºæ–‡ä»¶å
python3 view_diagnosis_reports_html.py --output my_report.html
```

**ç”Ÿæˆçš„æ–‡ä»¶**ï¼š`diagnosis_reports_view.html`

**åŠŸèƒ½ç‰¹æ€§**ï¼š
- ğŸ“Š ç»Ÿè®¡æ¦‚è§ˆå¡ç‰‡ï¼ˆæ€»æŠ¥å‘Šæ•°ã€å®Œæˆç‡ã€å¤±è´¥ç‡ç­‰ï¼‰
- ğŸ“‹ å¯æ’åºçš„æŠ¥å‘Šåˆ—è¡¨è¡¨æ ¼
- ğŸ“ˆ è¯¦ç»†çš„æŠ¥å‘Šæ•°æ®å±•ç¤º
- ğŸ” æ•°æ®å®Œæ•´æ€§æ£€æŸ¥ç»“æœ
- ğŸ“± å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒç§»åŠ¨è®¾å¤‡

---

### 3. Markdown æ‘˜è¦ç”Ÿæˆå™¨ (`generate_report_summary.py`)

**åŠŸèƒ½**ï¼šç”Ÿæˆ Markdown æ ¼å¼çš„æŠ¥å‘Šæ‘˜è¦

**ä½¿ç”¨æ–¹æ³•**ï¼š

```bash
cd backend_python
python3 generate_report_summary.py
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```markdown
# ğŸ“Š è¯Šæ–­æŠ¥å‘Šæ•°æ®å®Œæ•´æ€§æ£€æŸ¥æŠ¥å‘Š

## ğŸ“ˆ ç»Ÿè®¡æ¦‚è§ˆ
- âœ… å·²å®Œæˆï¼š6
- âŒ å¤±è´¥ï¼š3

## ğŸ“‹ æŠ¥å‘Šè¯¦ç»†æ•°æ®

### æŠ¥å‘Š #7: åä¸º
- Execution ID: `9b892873-1293-467e-8cef-dd9c78f985e2`
- ç”¨æˆ·ï¼šanonymous
- çŠ¶æ€ï¼šcompleted
- AI å¹³å°ï¼š2 ä¸ª - doubao, qwen
- é—®é¢˜ï¼š1 ä¸ª

**æŠ¥å‘Šæ•°æ®**:
- ç»´åº¦æ•°ï¼š1
- è´¨é‡è¯„åˆ†ï¼špoor (26.0)
```

---

## æ•°æ®åº“è¡¨ç»“æ„

### diagnosis_reports è¡¨
å­˜å‚¨è¯Šæ–­æŠ¥å‘Šçš„åŸºæœ¬ä¿¡æ¯ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | INTEGER | ä¸»é”® |
| execution_id | TEXT | å”¯ä¸€æ‰§è¡Œ ID |
| user_id | TEXT | ç”¨æˆ· ID |
| brand_name | TEXT | å“ç‰Œåç§° |
| competitor_brands | TEXT | ç«å“åˆ—è¡¨ (JSON) |
| selected_models | TEXT | AI å¹³å°é€‰æ‹© (JSON) |
| custom_questions | TEXT | è‡ªå®šä¹‰é—®é¢˜ (JSON) |
| status | TEXT | çŠ¶æ€ |
| progress | INTEGER | è¿›åº¦ (0-100) |
| stage | TEXT | é˜¶æ®µ |
| is_completed | BOOLEAN | æ˜¯å¦å®Œæˆ |
| created_at | TEXT | åˆ›å»ºæ—¶é—´ |
| updated_at | TEXT | æ›´æ–°æ—¶é—´ |
| completed_at | TEXT | å®Œæˆæ—¶é—´ |

### report_snapshots è¡¨
å­˜å‚¨å®Œæ•´çš„æŠ¥å‘Šæ•°æ®ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | INTEGER | ä¸»é”® |
| execution_id | TEXT | æ‰§è¡Œ ID |
| report_data | TEXT | å®Œæ•´æŠ¥å‘Šæ•°æ® (JSON) |
| report_version | TEXT | æŠ¥å‘Šç‰ˆæœ¬ |
| size_kb | INTEGER | å¿«ç…§å¤§å° (KB) |
| storage_timestamp | TEXT | å­˜å‚¨æ—¶é—´ |

### task_statuses è¡¨
å­˜å‚¨ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| task_id | TEXT | ä»»åŠ¡ ID |
| stage | TEXT | é˜¶æ®µ |
| progress | INTEGER | è¿›åº¦ |
| status_text | TEXT | çŠ¶æ€æ–‡æœ¬ |
| completed_count | INTEGER | å·²å®Œæˆæ•° |
| total_count | INTEGER | æ€»æ•° |
| is_completed | BOOLEAN | æ˜¯å¦å®Œæˆ |

---

## æ•°æ®å®Œæ•´æ€§æ£€æŸ¥é¡¹

æŸ¥çœ‹å™¨ä¼šè‡ªåŠ¨æ£€æŸ¥ä»¥ä¸‹é¡¹ç›®ï¼š

### âœ… å¿…å¡«å­—æ®µæ£€æŸ¥
- execution_id
- user_id
- brand_name
- status
- stage

### âœ… JSON æ ¼å¼æ£€æŸ¥
- competitor_brands
- selected_models
- custom_questions

### âœ… çŠ¶æ€ä¸€è‡´æ€§æ£€æŸ¥
- is_completed ä¸ status çš„ä¸€è‡´æ€§
- progress ä¸ status çš„åŒ¹é…æ€§

### âœ… æ•°æ®å®Œæ•´æ€§æ£€æŸ¥
- report_snapshots è¡¨æ˜¯å¦æœ‰å¯¹åº”è®°å½•
- å¿«ç…§æ•°æ®æ˜¯å¦å¯è§£æ
- dimensions æ•°ç»„æ˜¯å¦ä¸ºç©º

---

## å¿«é€Ÿæ£€æŸ¥è„šæœ¬

è¿è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆç»¼åˆç»Ÿè®¡æŠ¥å‘Šï¼š

```bash
cd backend_python
python3 -c "
import sqlite3
conn = sqlite3.connect('database.db')
cursor = conn.cursor()

# ç»Ÿè®¡
cursor.execute('SELECT COUNT(*) FROM diagnosis_reports')
total = cursor.fetchone()[0]

cursor.execute('SELECT COUNT(*) FROM diagnosis_reports WHERE is_completed = 1')
completed = cursor.fetchone()[0]

cursor.execute('SELECT COUNT(*) FROM report_snapshots')
snapshots = cursor.fetchone()[0]

print(f'æ€»æŠ¥å‘Šæ•°ï¼š{total}')
print(f'å·²å®Œæˆï¼š{completed} ({completed/total*100:.1f}%)')
print(f'å¿«ç…§æ•°ï¼š{snapshots}')

conn.close()
"
```

---

## å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆæŠ¥å‘Šæ˜¾ç¤º"ç»´åº¦æ•°ï¼š0"ï¼Ÿ
A: è¿™å¯èƒ½æ„å‘³ç€ AI è°ƒç”¨å¤±è´¥ï¼Œæ²¡æœ‰è·å–åˆ°æœ‰æ•ˆçš„åˆ†æç»“æœã€‚è¯·æ£€æŸ¥ï¼š
1. AI å¹³å° API Key æ˜¯å¦é…ç½®
2. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
3. æŸ¥çœ‹ task_statuses è¡¨ä¸­çš„é”™è¯¯ä¿¡æ¯

### Q: å¦‚ä½•å¯¼å‡ºç‰¹å®šæŠ¥å‘Šï¼Ÿ
A: ä½¿ç”¨ `--export` å‚æ•°ï¼š
```bash
python3 view_diagnosis_reports.py --export <execution_id>
```

### Q: HTML æŠ¥å‘Šåœ¨å“ªé‡Œï¼Ÿ
A: é»˜è®¤ç”Ÿæˆåœ¨ `backend_python/diagnosis_reports_view.html`ï¼Œç”¨æµè§ˆå™¨æ‰“å¼€å³å¯ã€‚

---

## æ•°æ®ä¿å­˜å®Œæ•´æ€§ç»“è®º

âœ… **æ•°æ®å·²å®Œæ•´ä¿å­˜**ï¼ŒåŒ…æ‹¬ï¼š

1. **è¯Šæ–­é…ç½®**ï¼šå“ç‰Œåç§°ã€ç«å“åˆ—è¡¨ã€AI å¹³å°é€‰æ‹©ã€è‡ªå®šä¹‰é—®é¢˜
2. **æ‰§è¡ŒçŠ¶æ€**ï¼šçŠ¶æ€ã€è¿›åº¦ã€é˜¶æ®µã€å®Œæˆæ ‡è®°
3. **æ—¶é—´æˆ³**ï¼šåˆ›å»ºæ—¶é—´ã€æ›´æ–°æ—¶é—´ã€å®Œæˆæ—¶é—´
4. **æŠ¥å‘Šæ•°æ®**ï¼šå®Œæ•´çš„ AI å“åº”ã€ç»´åº¦åˆ†æã€è´¨é‡è¯„åˆ†ï¼ˆå­˜å‚¨åœ¨ report_snapshots è¡¨ï¼‰
5. **ä»»åŠ¡çŠ¶æ€**ï¼šè¯¦ç»†çš„æ‰§è¡Œè¿›åº¦å’Œé”™è¯¯ä¿¡æ¯

æ‰€æœ‰æ•°æ®éƒ½å¯ä»¥é€šè¿‡ä¸Šè¿°å·¥å…·æŸ¥çœ‹å’Œå¯¼å‡ºã€‚
