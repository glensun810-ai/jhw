# AI平台接入实施计划 - 总结

## 计划概述

本计划详细描述了如何参考豆包MVP的成功经验，按顺序调通 **DeepSeek**、**通义千问(Qwen)**、**智谱AI(Zhipu)** 三个AI平台。

## 已准备的API密钥

```bash
# DeepSeek
DEEPSEEK_API_KEY=sk-13908093890f46fb82c52a01c8dfc464

# 通义千问
QWEN_API_KEY=sk-5261a4dfdf964a5c9a6364128cc4c653

# 智谱AI
ZHIPU_API_KEY=504d64a0ad234557a79ad0dbcba3685c.ZVznXgPMIsnHbiNh
```

## 实施文档清单

| 文档 | 说明 | 预计时间 |
|------|------|----------|
| **AI_Platform_Integration_Plan.md** | 总体实施计划 | - |
| **Phase1_DeepSeek_Implementation.md** | DeepSeek详细任务清单 | 3小时 |
| **Phase2_Qwen_Implementation.md** | 通义千问详细任务清单 | 2.5小时 |
| **Phase3_Zhipu_Implementation.md** | 智谱AI详细任务清单 | 2.5小时 |
| **execute_integration_plan.py** | 自动化执行脚本 | - |

## 快速开始

### 第一步：自动执行基础测试

```bash
cd /Users/sgl/PycharmProjects/PythonProject/backend_python
python execute_integration_plan.py
```

此脚本将自动：
1. 测试DeepSeek适配器基础功能
2. 测试Qwen适配器基础功能
3. 测试Zhipu适配器基础功能
4. 生成测试报告

### 第二步：按阶段手动实施

根据自动化测试的结果，按照各阶段的Implementation文档手动完成：

#### 阶段1：DeepSeek（3小时）

```bash
# 1. 详细阅读任务文档
cat Phase1_DeepSeek_Implementation.md

# 2. 执行测试脚本
python test_deepseek_integration.py

# 3. 按照文档步骤，在views.py中添加MVP接口
# 4. 创建前端测试页面
# 5. 性能测试
# 6. 集成到主程序
```

#### 阶段2：通义千问（2.5小时）

```bash
# 1. 详细阅读任务文档
cat Phase2_Qwen_Implementation.md

# 2. 执行测试脚本
python test_qwen_integration.py

# 3-6. 按照文档步骤完成实施
```

#### 阶段3：智谱AI（2.5小时）

```bash
# 1. 详细阅读任务文档
cat Phase3_Zhipu_Implementation.md

# 2. 执行测试脚本
python test_zhipu_integration.py

# 3-6. 按照文档步骤完成实施
```

## 实施顺序

```
┌─────────────────────────────────────────────────────────────┐
│                    实施流程图                                │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌──────────────┐                                          │
│  │ 自动化测试    │                                          │
│  │ 三个平台基础  │                                          │
│  │ 功能验证     │                                          │
│  └──────┬───────┘                                          │
│         │                                                   │
│         ▼                                                   │
│  ┌──────────────┐    失败    ┌──────────────┐             │
│  │ 所有平台测试  │ ─────────▶ │  修复问题     │             │
│  │ 通过？       │            │  重新测试     │             │
│  └──────┬───────┘            └──────────────┘             │
│         │ 通过                                              │
│         ▼                                                   │
│  ┌──────────────┐                                          │
│  │ 阶段1:       │                                          │
│  │ DeepSeek     │ ◀── 参考豆包MVP经验                      │
│  │ (3小时)      │                                          │
│  └──────┬───────┘                                          │
│         │                                                   │
│         ▼                                                   │
│  ┌──────────────┐                                          │
│  │ 阶段2:       │                                          │
│  │ 通义千问     │                                          │
│  │ (2.5小时)    │                                          │
│  └──────┬───────┘                                          │
│         │                                                   │
│         ▼                                                   │
│  ┌──────────────┐                                          │
│  │ 阶段3:       │                                          │
│  │ 智谱AI       │                                          │
│  │ (2.5小时)    │                                          │
│  └──────┬───────┘                                          │
│         │                                                   │
│         ▼                                                   │
│  ┌──────────────┐                                          │
│  │ 多平台并发   │                                          │
│  │ 测试与优化   │                                          │
│  └──────┬───────┘                                          │
│         │                                                   │
│         ▼                                                   │
│  ┌──────────────┐                                          │
│  │ 全部完成！   │                                          │
│  │ ✅✅✅       │                                          │
│  └──────────────┘                                          │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## 关键成功因素

### 1. 参考豆包MVP的成功模式

豆包MVP成功的关键点：
- ✅ 顺序执行，确保每个问题都拿到结果
- ✅ 使用90秒超时（豆包响应较慢）
- ✅ 详细记录AI响应日志
- ✅ 实时更新进度状态
- ✅ 完善的错误处理

### 2. 各平台特性

| 平台 | 响应速度 | 建议超时 | 特点 |
|------|---------|----------|------|
| DeepSeek | 快 (5-15s) | 30秒 | 响应快，质量高 |
| 通义千问 | 中 (10-20s) | 45秒 | 中文理解好 |
| 智谱AI | 中 (10-20s) | 45秒 | 国内服务稳定 |
| 豆包 | 慢 (40-60s) | 90秒 | MVP已验证 |

### 3. 配置参数

```python
# 超时配置（秒）
TIMEOUT_CONFIG = {
    'deepseek': 30,
    'qwen': 45,
    'zhipu': 45,
    'doubao': 90,
}

# 模型名称映射
MODEL_NAME_MAP = {
    'deepseek': 'deepseek-chat',
    'qwen': 'qwen-max',
    'zhipu': 'glm-4',
    'doubao': os.getenv('DOUBAO_MODEL_ID', 'doubao-pro-32k'),
}
```

## 验收标准

### 功能验收
- [ ] DeepSeek平台可正常调用并返回结果
- [ ] 通义千问平台可正常调用并返回结果
- [ ] 智谱AI平台可正常调用并返回结果
- [ ] 多平台并发调用正常
- [ ] 结果聚合和展示正常

### 性能验收
- [ ] DeepSeek平均响应时间 < 15秒
- [ ] 通义千问平均响应时间 < 20秒
- [ ] 智谱AI平均响应时间 < 20秒
- [ ] 多平台并发无超时

### 质量验收
- [ ] AI响应日志记录完整
- [ ] 错误处理完善
- [ ] 监控指标正常

## 风险与应对

| 风险 | 可能性 | 影响 | 应对措施 |
|------|--------|------|----------|
| API密钥无效 | 中 | 高 | 提前验证密钥，准备备用密钥 |
| API响应格式变化 | 低 | 中 | 添加格式验证，记录原始响应 |
| 网络超时 | 中 | 中 | 设置合理超时，实现重试机制 |
| 前端403错误 | 高 | 高 | 优先解决或使用测试脚本绕过 |

## 下一步行动

1. **立即执行**：运行 `execute_integration_plan.py` 进行自动化测试
2. **根据结果**：按照各阶段文档手动完成实施
3. **持续验证**：每完成一个平台，立即验证功能
4. **最终集成**：完成多平台并发测试

## 联系与支持

如遇到问题，请参考：
- 各阶段的Implementation文档中的"问题排查指南"
- 豆包MVP的成功实现代码（views.py中的mvp_brand_test函数）
- 现有的适配器实现代码

---

**计划制定时间**: 2026-02-15
**计划版本**: 1.0
**预计总耗时**: 8小时（3个平台）
